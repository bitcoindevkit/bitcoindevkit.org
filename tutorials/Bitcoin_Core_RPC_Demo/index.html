<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>BDK wallet with Bitcoin core RPC  | Bitcoin Dev Kit Documentation</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="preload" href="/fonts/ibm-plex-mono-400.woff2" as="font" crossorigin="true">
    <link rel="apple-touch-icon" sizes="180x180" href="/img/favicon/apple-touch-icon.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="stylesheet" href="/css/variables.css">
    <link name="msapplication-config" content="/browserconfig.xml">
    <link name="msapplication-TileColor" content="#ffffff">
    <link name="theme-color" content="#ffffff">
    <meta name="description" content="Tutorial showing usage of Bitcoin core backend with BDK wallet">
    <meta property="article:published_time" content="2021-08-21T00:00:00.000Z">
    <meta property="og:site_name" content="Bitcoin Dev Kit Documentation">
    <meta property="og:title" content="BDK wallet with Bitcoin core RPC">
    <meta property="og:description" content="Tutorial showing usage of Bitcoin core backend with BDK wallet">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://bitcoindevkit.org/tutorials/Bitcoin_Core_RPC_Demo/">
    <meta property="og:image" content="https://bitcoindevkit.org/card.png">
    <meta name="twitter:title" content="BDK wallet with Bitcoin core RPC">
    <meta name="twitter:description" content="Tutorial showing usage of Bitcoin core backend with BDK wallet">
    <meta name="twitter:url" content="https://bitcoindevkit.org/tutorials/Bitcoin_Core_RPC_Demo/">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content="https://bitcoindevkit.org/card.png">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="tutorial, BDK, Bitcoin Core, RPC, Wallet">
    <meta property="article:tag" content="tutorial">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    
    <link rel="preload" href="/assets/css/0.styles.5522b66b.css" as="style"><link rel="preload" href="/assets/js/app.d51c0966.js" as="script"><link rel="preload" href="/assets/js/9.e360c80b.js" as="script"><link rel="preload" href="/assets/js/1.2e1eea68.js" as="script"><link rel="preload" href="/assets/js/49.326245ce.js" as="script"><link rel="prefetch" href="/assets/js/10.75aa7187.js"><link rel="prefetch" href="/assets/js/11.f7cd811c.js"><link rel="prefetch" href="/assets/js/12.4b293c8f.js"><link rel="prefetch" href="/assets/js/13.b0ce0b72.js"><link rel="prefetch" href="/assets/js/14.60b1238e.js"><link rel="prefetch" href="/assets/js/15.d3587424.js"><link rel="prefetch" href="/assets/js/16.4b1106af.js"><link rel="prefetch" href="/assets/js/17.332b10dc.js"><link rel="prefetch" href="/assets/js/18.e561b6d2.js"><link rel="prefetch" href="/assets/js/19.f371f1e7.js"><link rel="prefetch" href="/assets/js/20.2b1bf0c5.js"><link rel="prefetch" href="/assets/js/21.a3b7d87d.js"><link rel="prefetch" href="/assets/js/22.7914f825.js"><link rel="prefetch" href="/assets/js/23.2d24994a.js"><link rel="prefetch" href="/assets/js/24.a5987c74.js"><link rel="prefetch" href="/assets/js/25.862eb834.js"><link rel="prefetch" href="/assets/js/26.29d0e321.js"><link rel="prefetch" href="/assets/js/27.0956632b.js"><link rel="prefetch" href="/assets/js/28.489d36dc.js"><link rel="prefetch" href="/assets/js/29.dfcf1240.js"><link rel="prefetch" href="/assets/js/30.29f297b1.js"><link rel="prefetch" href="/assets/js/31.38aa3f6d.js"><link rel="prefetch" href="/assets/js/32.fec2cb6c.js"><link rel="prefetch" href="/assets/js/33.4e6ea314.js"><link rel="prefetch" href="/assets/js/34.e7355035.js"><link rel="prefetch" href="/assets/js/35.479b384d.js"><link rel="prefetch" href="/assets/js/36.37ba377f.js"><link rel="prefetch" href="/assets/js/37.717c00b9.js"><link rel="prefetch" href="/assets/js/38.ed976ddb.js"><link rel="prefetch" href="/assets/js/39.9b459bee.js"><link rel="prefetch" href="/assets/js/40.0886e2f5.js"><link rel="prefetch" href="/assets/js/41.3a1f942a.js"><link rel="prefetch" href="/assets/js/42.ff223d38.js"><link rel="prefetch" href="/assets/js/43.b899d421.js"><link rel="prefetch" href="/assets/js/44.4a62a141.js"><link rel="prefetch" href="/assets/js/45.4ac6431a.js"><link rel="prefetch" href="/assets/js/46.bdb409b2.js"><link rel="prefetch" href="/assets/js/47.15e84c2a.js"><link rel="prefetch" href="/assets/js/48.f08c0b27.js"><link rel="prefetch" href="/assets/js/5.06e92c41.js"><link rel="prefetch" href="/assets/js/50.16f6cb20.js"><link rel="prefetch" href="/assets/js/51.1c3f4842.js"><link rel="prefetch" href="/assets/js/52.00d1a14f.js"><link rel="prefetch" href="/assets/js/53.bd54bedd.js"><link rel="prefetch" href="/assets/js/54.4bad0175.js"><link rel="prefetch" href="/assets/js/55.f354f14c.js"><link rel="prefetch" href="/assets/js/56.29f3287c.js"><link rel="prefetch" href="/assets/js/57.84baf206.js"><link rel="prefetch" href="/assets/js/6.4f0e29df.js"><link rel="prefetch" href="/assets/js/7.4cf88d66.js"><link rel="prefetch" href="/assets/js/8.ad6d42e3.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.567a400b.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.e2882327.js">
    <link rel="stylesheet" href="/assets/css/0.styles.5522b66b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-9ca807bc><header class="navbar" data-v-9ca807bc><div class="wrap"><div class="wrap-border"><a href="/" class="home-link router-link-active"><svg role="img" alt="Bitcoin Dev Kit Documentation" class="logo"><use href="/img/logo.svg#small" class="small"></use> <use href="/img/logo.svg#large" class="large"></use></svg></a> <div class="links"><nav class="nav-links can-hide"><div class="nav-item"><a href="/getting-started/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="/tutorials/hello-world.html" class="nav-link">
  Tutorials
</a></div><div class="nav-item"><a href="/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="https://discord.gg/dstn4dQ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/bitcoindevkit" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/bitcoindevkit/bitcoindevkit.org" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <button type="button" class="theme-switch"><svg viewBox="0 0 30 31" fill="none" xmlns="http://www.w3.org/2000/svg"><g class="theme-switch-dark"><path d="M15 20.4219C12.5187 20.4219 10.5 18.4032 10.5 15.9219C10.5 13.4406 12.5187 11.4219 15 11.4219C17.4813 11.4219 19.5 13.4406 19.5 15.9219C19.5 18.4032 17.4813 20.4219 15 20.4219Z" fill="currentColor"></path> <path d="M19.4541 20.3769L21.3644 22.2862M15 24.9219V22.2219V24.9219ZM15 9.62187V6.92188V9.62187ZM6 15.9219H8.7H6ZM21.3 15.9219H24H21.3ZM8.6361 22.2862L10.5454 20.3769L8.6361 22.2862ZM19.4541 11.4678L21.3644 9.55797L19.4541 11.4678ZM8.6361 9.55797L10.5454 11.4678L8.6361 9.55797Z" stroke="currentColor" stroke-width="1" stroke-linecap="round"></path></g> <g fill="currentColor" class="theme-switch-light"><path d="M10.1539 8.75585C10.018 8.75585 9.88774 8.70189 9.79168 8.60583C9.69563 8.50977 9.64166 8.37949 9.64166 8.24365V6.19482C9.64166 6.05898 9.69563 5.9287 9.79168 5.83264C9.88774 5.73658 10.018 5.68262 10.1539 5.68262C10.2897 5.68262 10.42 5.73658 10.5161 5.83264C10.6121 5.9287 10.6661 6.05898 10.6661 6.19482V8.24365C10.6661 8.37949 10.6121 8.50977 10.5161 8.60583C10.42 8.70189 10.2897 8.75585 10.1539 8.75585Z"></path> <path d="M11.1783 7.73144H9.12945C8.9936 7.73144 8.86332 7.67748 8.76726 7.58142C8.6712 7.48536 8.61724 7.35508 8.61724 7.21924C8.61724 7.08339 8.6712 6.95311 8.76726 6.85705C8.86332 6.761 8.9936 6.70703 9.12945 6.70703H11.1783C11.3141 6.70703 11.4444 6.761 11.5405 6.85705C11.6365 6.95311 11.6905 7.08339 11.6905 7.21924C11.6905 7.35508 11.6365 7.48536 11.5405 7.58142C11.4444 7.67748 11.3141 7.73144 11.1783 7.73144ZM6.05621 13.8779C5.92037 13.8779 5.79009 13.8239 5.69403 13.7279C5.59797 13.6318 5.54401 13.5015 5.54401 13.3657V12.3413C5.54401 12.2054 5.59797 12.0752 5.69403 11.9791C5.79009 11.8831 5.92037 11.8291 6.05621 11.8291C6.19206 11.8291 6.32234 11.8831 6.4184 11.9791C6.51445 12.0752 6.56842 12.2054 6.56842 12.3413V13.3657C6.56842 13.5015 6.51445 13.6318 6.4184 13.7279C6.32234 13.8239 6.19206 13.8779 6.05621 13.8779Z"></path> <path d="M6.56842 13.366H5.544C5.40816 13.366 5.27788 13.312 5.18182 13.216C5.08576 13.1199 5.0318 12.9896 5.0318 12.8538C5.0318 12.7179 5.08576 12.5877 5.18182 12.4916C5.27788 12.3955 5.40816 12.3416 5.544 12.3416H6.56842C6.70426 12.3416 6.83454 12.3955 6.9306 12.4916C7.02666 12.5877 7.08062 12.7179 7.08062 12.8538C7.08062 12.9896 7.02666 13.1199 6.9306 13.216C6.83454 13.312 6.70426 13.366 6.56842 13.366ZM16.8125 23.6101C12.8583 23.6101 9.64165 20.3934 9.64165 16.4392C9.64165 12.8983 12.2851 9.85021 15.7907 9.34876L16.4658 9.25195L16.37 9.92755C16.326 10.218 16.3027 10.5112 16.3003 10.805C16.3003 14.1942 19.0575 16.9514 22.4468 16.9514C22.708 16.9514 22.9872 16.9294 23.3247 16.8813L23.9998 16.7855L23.9035 17.4606C23.401 20.9666 20.3524 23.6101 16.8125 23.6101Z"></path></g></svg></button></div> <div class="sidebar-button"><svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" class="icon"><g fill="currentColor" class="hamburger"><path d="M33.75 11.6699H6.25C5.55964 11.6699 5 12.2296 5 12.9199C5 13.6103 5.55964 14.1699 6.25 14.1699H33.75C34.4404 14.1699 35 13.6103 35 12.9199C35 12.2296 34.4404 11.6699 33.75 11.6699Z"></path> <path d="M28.75 18.752H6.25C5.55964 18.752 5 19.3116 5 20.002C5 20.6923 5.55964 21.252 6.25 21.252H28.75C29.4404 21.252 30 20.6923 30 20.002C30 19.3116 29.4404 18.752 28.75 18.752Z"></path> <path d="M33.75 25.8301H6.25C5.55964 25.8301 5 26.3897 5 27.0801C5 27.7704 5.55964 28.3301 6.25 28.3301H33.75C34.4404 28.3301 35 27.7704 35 27.0801C35 26.3897 34.4404 25.8301 33.75 25.8301Z"></path></g> <g stroke="currentColor" class="close"><path d="M10 10L30 30" stroke-width="2" stroke-linecap="round"></path> <path d="M30 10L10 30" stroke-width="2" stroke-linecap="round"></path></g></svg></div></div></div></header> <div class="wrap" data-v-9ca807bc><div class="wrap-border" data-v-9ca807bc><div class="sidebar-mask" data-v-9ca807bc></div> <aside class="sidebar" data-v-9ca807bc><nav class="nav-links"><div class="nav-item"><a href="/getting-started/" class="nav-link">
  Docs
</a></div><div class="nav-item"><a href="/tutorials/hello-world.html" class="nav-link">
  Tutorials
</a></div><div class="nav-item"><a href="/blog/" class="nav-link">
  Blog
</a></div><div class="nav-item"><a href="https://discord.gg/dstn4dQ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://github.com/bitcoindevkit" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/bitcoindevkit/bitcoindevkit.org" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Tutorials</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/2020/12/hello-world/" class="sidebar-link">Hello World!</a></li><li><a href="/tutorials/Bitcoin_Core_RPC_Demo/" aria-current="page" class="active sidebar-link">BDK wallet with Bitcoin core RPC</a></li><li><a href="/tutorials/compact_filters_demo/" class="sidebar-link">BDK wallet as a BIP157 SPV light client</a></li><li><a href="/tutorials/descriptors_in_the_wild/" class="sidebar-link">A Multisig between BDK and Core</a></li><li><a href="/tutorials/hidden-power-of-bitcoin/" class="sidebar-link">Hidden Powers of Miniscript Policy &amp; Descriptors</a></li><li><a href="/tutorials/descriptor_based_paper_wallet/" class="sidebar-link">Making Descriptor-based paper wallets</a></li><li><a href="/tutorials/spending_policy_demo/" class="sidebar-link">Spending Policy Decoded</a></li><li><a href="/tutorials/exploring_bdk_rn/" class="sidebar-link">BDK-RN: Building React Native Apps with BDK</a></li><li><a href="/tutorials/using_bdk_with_hardware_wallets/" class="sidebar-link">Using BDK with hardware wallets</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="introduction"><a href="#introduction" class="header-anchor">#</a> Introduction</h2> <p>BDK wallet developer library can be used to easily deploy wallets with various kinds of blockchain backend support, like <a href="https://github.com/romanz/electrs" target="_blank" rel="noopener noreferrer"><code>electrum</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <a href="https://github.com/Blockstream/esplora" target="_blank" rel="noopener noreferrer"><code>esplora</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, <code>compact-filters</code> (<a href="https://github.com/bitcoin/bips/blob/master/bip-0157.mediawiki" target="_blank" rel="noopener noreferrer">BIP157<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>) etc. With the latest release of BDK <a href="https://github.com/bitcoindevkit/bdk/releases/tag/v0.10.0" target="_blank" rel="noopener noreferrer"><code>v0.10.0</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, BDK now supports Bitcoin Core as a blockchain backend. BDK talks with Bitcoin Core using rust-bitcoin's <a href="https://github.com/rust-bitcoin/rust-bitcoincore-rpc" target="_blank" rel="noopener noreferrer">bitcoincore-rpc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> library.</p> <p>This allows wallet devs to quickly deploy their wallet that can talk to a bitcoin full node (home raspi nodes) out of the box. Wallet devs don't need to worry about connecting to a full node with correct RPC calls, all of that is handled by BDK under the hood. All they need is to identify the full node's RPC IP address and the correct RPC credentials.</p> <p>In this tutorial we will see how to write a very simplistic wallet code that can connect to a bitcoin core node and maintain its balance and make transactions.</p> <p>Unlike other tutorials, we will not use <code>bdk-cli</code> tools, but instead write rust code directly using <code>BDK</code> devkit. In the end we will end up with our own simple bitcoin wallet.</p> <h2 id="prerequisite"><a href="#prerequisite" class="header-anchor">#</a> Prerequisite</h2> <p>To run with this tutorial you would need to have a bitcoin core node running in regtest mode. Get the bitcoin core binary either from the <a href="https://bitcoincore.org/bin/bitcoin-core-0.21.1/" target="_blank" rel="noopener noreferrer">bitcoin core repo<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> or <a href="https://github.com/bitcoin/bitcoin/blob/v0.21.1/doc/build-unix.md" target="_blank" rel="noopener noreferrer">build from source<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Then configure the node with a following <code>bitcoin.conf</code> file</p> <div class="language-txt extra-class"><pre class="language-txt"><code>regtest=1
fallbackfee=0.0001
server=1
txindex=1
rpcuser=admin
rpcpassword=password
</code></pre></div><p>Apart from that, you would need to install rust in your system. Grab the installation one-liner from <a href="https://www.rust-lang.org/tools/install" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <h2 id="setting-up"><a href="#setting-up" class="header-anchor">#</a> Setting Up</h2> <p>Create a new cargo binary repository.</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">mkdir</span> ~/tutorial
<span class="token builtin class-name">cd</span> tutorial
cargo new bdk-example
<span class="token builtin class-name">cd</span> bdk-example
</code></pre></div><p>This will create a new project folder named <code>bdk-example</code> with <code>src/main.rs</code> and a <code>cargo.toml</code>.</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ tree -L <span class="token number">3</span> <span class="token builtin class-name">.</span>
<span class="token builtin class-name">.</span>
├── Cargo.toml
└── src
    └── main.rs

<span class="token number">1</span> directory, <span class="token number">2</span> files
</code></pre></div><p>Opening <code>main.rs</code> you will see some predefined code like this</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, world!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Try running <code>cargo run</code> and if everything is set, you should see &quot;Hello, world!&quot; printed in your terminal</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ cargo run
    Compiling bdk-example v0.1.0 <span class="token punctuation">(</span>/home/raj/github-repo/tutorial/bdk-example<span class="token punctuation">)</span>
    Finished dev <span class="token punctuation">[</span>unoptimized + debuginfo<span class="token punctuation">]</span> target<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">0</span>.95s
    Running <span class="token variable"><span class="token variable">`</span>target/debug/bdk-example<span class="token variable">`</span></span>
Hello, world<span class="token operator">!</span>
</code></pre></div><p>Of course we will not use the given <code>println!()</code> statement, but we will put our main code in the <code>main()</code> function.</p> <p><code>cargo new</code> will also produce a skeleton <code>Cargo.toml</code> file like this</p> <div class="language-toml extra-class"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">package</span><span class="token punctuation">]</span>
<span class="token key property">name</span> <span class="token punctuation">=</span> <span class="token string">&quot;bdk-example&quot;</span>
<span class="token key property">version</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.1.0&quot;</span>
<span class="token key property">edition</span> <span class="token punctuation">=</span> <span class="token string">&quot;2018&quot;</span>

<span class="token comment"># See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html</span>

<span class="token punctuation">[</span><span class="token table class-name">dependencies</span><span class="token punctuation">]</span>
</code></pre></div><h2 id="setting-dependencies"><a href="#setting-dependencies" class="header-anchor">#</a> Setting dependencies</h2> <p>Once the rust binary is compiled and running, we now need to specify the dependencies we need to work on our library.</p> <p>Remember that BDK provides almost everything we would need to build a wallet out of the box. So we don't need any more dependencies apart from BDK. We will use another small rust crate called <a href="https://crates.io/crates/dirs-next" target="_blank" rel="noopener noreferrer"><code>dirs_next</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> to find our home directory and store wallet files in a subfolder there.</p> <p>Add the dependencies into <code>Cargo.toml</code> like below</p> <div class="language-toml extra-class"><pre class="language-toml"><code><span class="token punctuation">[</span><span class="token table class-name">package</span><span class="token punctuation">]</span>
<span class="token key property">name</span> <span class="token punctuation">=</span> <span class="token string">&quot;bdk-example&quot;</span>
<span class="token key property">version</span> <span class="token punctuation">=</span> <span class="token string">&quot;0.1.0&quot;</span>
<span class="token key property">edition</span> <span class="token punctuation">=</span> <span class="token string">&quot;2018&quot;</span>

<span class="token comment"># See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html</span>

<span class="token punctuation">[</span><span class="token table class-name">dependencies</span><span class="token punctuation">]</span>
<span class="token key property">bdk</span> <span class="token punctuation">=</span> <span class="token punctuation">{</span> <span class="token key property">version</span> <span class="token punctuation">=</span> <span class="token string">&quot;^0.10&quot;</span><span class="token punctuation">,</span> <span class="token key property">default-features</span> <span class="token punctuation">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token key property">features</span> <span class="token punctuation">=</span> <span class="token punctuation">[</span><span class="token string">&quot;all-keys&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;key-value-db&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;rpc&quot;</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
<span class="token key property">dirs-next</span> <span class="token punctuation">=</span> <span class="token string">&quot;2.0&quot;</span>
</code></pre></div><p>We disabled the default BDK feature (which specifies blockchain backend as an electrum server) and we requested the following features:</p> <ul><li><strong>all-keys</strong>: Adds BIP39 key derivation capabilities</li> <li><strong>key-value-db</strong>: Adds a persistance storage capability</li> <li><strong>rpc</strong>: Adds the RPC blockchain backend capability.</li></ul> <p>Now that we have the dependcies added, we can import them in the <code>main.rs</code> file to use in our code.
Add the following imports at the start of <code>main.rs</code></p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>bitcoin<span class="token punctuation">::</span></span><span class="token class-name">Network</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>bitcoin<span class="token punctuation">::</span>secp256k1<span class="token punctuation">::</span></span><span class="token class-name">Secp256k1</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>bitcoin<span class="token punctuation">::</span>util<span class="token punctuation">::</span>bip32<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">DerivationPath</span><span class="token punctuation">,</span> <span class="token class-name">KeySource</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>bitcoin<span class="token punctuation">::</span></span><span class="token class-name">Amount</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>bitcoincore_rpc<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Auth</span> <span class="token keyword">as</span> rpc_auth<span class="token punctuation">,</span> <span class="token class-name">Client</span><span class="token punctuation">,</span> <span class="token class-name">RpcApi</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>blockchain<span class="token punctuation">::</span>rpc<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Auth</span><span class="token punctuation">,</span> <span class="token class-name">RpcBlockchain</span><span class="token punctuation">,</span> <span class="token class-name">RpcConfig</span><span class="token punctuation">,</span> wallet_name_from_descriptor<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>blockchain<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">ConfigurableBlockchain</span><span class="token punctuation">,</span> <span class="token class-name">NoopProgress</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>keys<span class="token punctuation">::</span>bip39<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Mnemonic</span><span class="token punctuation">,</span> <span class="token class-name">Language</span><span class="token punctuation">,</span> <span class="token class-name">MnemonicType</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>keys<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">GeneratedKey</span><span class="token punctuation">,</span> <span class="token class-name">GeneratableKey</span><span class="token punctuation">,</span> <span class="token class-name">ExtendedKey</span><span class="token punctuation">,</span> <span class="token class-name">DerivableKey</span><span class="token punctuation">,</span> <span class="token class-name">DescriptorKey</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>keys<span class="token punctuation">::</span></span><span class="token class-name">DescriptorKey</span><span class="token punctuation">::</span><span class="token class-name">Secret</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>miniscript<span class="token punctuation">::</span>miniscript<span class="token punctuation">::</span></span><span class="token class-name">Segwitv0</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span></span><span class="token class-name">Wallet</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>wallet<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">AddressIndex</span><span class="token punctuation">,</span> <span class="token namespace">signer<span class="token punctuation">::</span></span><span class="token class-name">SignOptions</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span></span>sled<span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">str</span><span class="token punctuation">::</span><span class="token class-name">FromStr</span><span class="token punctuation">;</span>
</code></pre></div><p>With this we are now ready to add our wallet code.</p> <h2 id="getting-descriptors"><a href="#getting-descriptors" class="header-anchor">#</a> Getting Descriptors</h2> <p>BDK is a descriptor based wallet library. That means when we specify our wallet key-chain we need to tell BDK about it in the format of a descriptor. You can read up on descriptors more <a href="https://bitcoindevkit.org/descriptors/" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. A descriptor string looks like this
<code>&quot;wpkh([b8b575c2/84'/1'/0'/0]tprv8icWtRzy9CWgFxpGMLSdAeE4wWyz39XGc6SwykeTo13tYm14JkVVQAf7jz8WDDarCgNJrG3aEPJEqchDWeJdiaWpS3FwbLB9SzsN57V7qxB/*)&quot;</code>.</p> <p>This describes a SegwitV0 descriptor of a key derived at path <code>m/84'/1'/0'/0</code>. If you already have a descriptor from other sources, you can use that. Otherwise, BDK has your back. BDK can be used to generate a fresh master key with mnemonic, and then derive child keys from it given a specific path. Putting the key in a descriptor is as simple as wrapping it with a <code>wpkh()</code> string.</p> <p>We will use a dedicated function that will create fresh receive and change descriptors from BDK for our purpose. It will also generate the mnemonic word list for later regenerating the wallet. But we will ignore that for our scope.</p> <p>Add a function named <code>get-descriptor()</code> below the <code>main()</code> function as shown</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">...</span>
<span class="token punctuation">}</span>

<span class="token comment">// generate fresh descriptor strings and return them via (receive, change) tuple</span>
<span class="token keyword">fn</span> <span class="token function-definition function">get_descriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create a new secp context</span>
    <span class="token keyword">let</span> secp <span class="token operator">=</span> <span class="token class-name">Secp256k1</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
     
    <span class="token comment">// You can also set a password to unlock the mnemonic</span>
    <span class="token keyword">let</span> password <span class="token operator">=</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;random password&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Generate a fresh mnemonic, and from there a privatekey</span>
    <span class="token keyword">let</span> mnemonic<span class="token punctuation">:</span> <span class="token class-name">GeneratedKey</span><span class="token operator">&lt;</span>_<span class="token punctuation">,</span> <span class="token class-name">Segwitv0</span><span class="token operator">&gt;</span> <span class="token operator">=</span>
                <span class="token class-name">Mnemonic</span><span class="token punctuation">::</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">MnemonicType</span><span class="token punctuation">::</span><span class="token class-name">Words12</span><span class="token punctuation">,</span> <span class="token class-name">Language</span><span class="token punctuation">::</span><span class="token class-name">English</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> mnemonic <span class="token operator">=</span> mnemonic<span class="token punctuation">.</span><span class="token function">into_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> xkey<span class="token punctuation">:</span> <span class="token class-name">ExtendedKey</span> <span class="token operator">=</span> <span class="token punctuation">(</span>mnemonic<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">into_extended_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> xprv <span class="token operator">=</span> xkey<span class="token punctuation">.</span><span class="token function">into_xprv</span><span class="token punctuation">(</span><span class="token class-name">Network</span><span class="token punctuation">::</span><span class="token class-name">Regtest</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Create derived privkey from the above master privkey</span>
    <span class="token comment">// We use the following derivation paths for receive and change keys</span>
    <span class="token comment">// receive: &quot;m/84h/1h/0h/0&quot;</span>
    <span class="token comment">// change: &quot;m/84h/1h/0h/1&quot; </span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> keys <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> path <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">&quot;m/84h/1h/0h/0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;m/84h/1h/0h/1&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> deriv_path<span class="token punctuation">:</span> <span class="token class-name">DerivationPath</span> <span class="token operator">=</span> <span class="token class-name">DerivationPath</span><span class="token punctuation">::</span><span class="token function">from_str</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> derived_xprv <span class="token operator">=</span> <span class="token operator">&amp;</span>xprv<span class="token punctuation">.</span><span class="token function">derive_priv</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>secp<span class="token punctuation">,</span> <span class="token operator">&amp;</span>deriv_path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> origin<span class="token punctuation">:</span> <span class="token class-name">KeySource</span> <span class="token operator">=</span> <span class="token punctuation">(</span>xprv<span class="token punctuation">.</span><span class="token function">fingerprint</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>secp<span class="token punctuation">)</span><span class="token punctuation">,</span> deriv_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> derived_xprv_desc_key<span class="token punctuation">:</span> <span class="token class-name">DescriptorKey</span><span class="token operator">&lt;</span><span class="token class-name">Segwitv0</span><span class="token operator">&gt;</span> <span class="token operator">=</span>
        derived_xprv<span class="token punctuation">.</span><span class="token function">into_descriptor_key</span><span class="token punctuation">(</span><span class="token class-name">Some</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">DerivationPath</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Wrap the derived key with the wpkh() string to produce a descriptor string</span>
        <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Secret</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=</span> derived_xprv_desc_key <span class="token punctuation">{</span>
            <span class="token keyword">let</span> <span class="token keyword">mut</span> desc <span class="token operator">=</span> <span class="token string">&quot;wpkh(&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            desc<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>key<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            desc<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Return the keys as a tuple</span>
    <span class="token punctuation">(</span>keys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> keys<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p>To check that the above added function is working as expected, call it in the main function and print the descriptors</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token punctuation">...</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>receive_desc<span class="token punctuation">,</span> change_desc<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">get_descriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;recv: {:#?}, \nchng: {:#?}&quot;</span><span class="token punctuation">,</span> receive_desc<span class="token punctuation">,</span> change_desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">fn</span> <span class="token function-definition function">get_descriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">...</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Running the binary should produces the following result</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ cargo run
recv: <span class="token string">&quot;wpkh([89df6a67/84'/1'/0'/0]tprv8iSRXyLtTKJN9qt1jyPVqwhDMEaYztXunPaRQznaH1z8gj8e2g7RnF2ZoHP56VEXwMn76AiV1Je6nJmZbFistwAQCrRGmSrsoKfdqfTDNA1/*)&quot;</span>, 
chng: <span class="token string">&quot;wpkh([89df6a67/84'/1'/0'/1]tprv8iSRXyLtTKJNCECQxBJ19cgx2ueS7mC7GNq7VqTWY3RNPMBY7DfTb9HUnXpJqa14jCJNRmi4yGxfoTVS4WLBXDkvTLq4vujeAD9NfDtSxGP/*)&quot;</span>
</code></pre></div><p>Voila! Now we have nice descriptors strings handy to use for our BDK wallet construction.</p> <h2 id="talking-to-bitcoin-core-programmatically"><a href="#talking-to-bitcoin-core-programmatically" class="header-anchor">#</a> Talking to Bitcoin Core Programmatically</h2> <p>Like all other tutorials we will use two wallets to send coins back and forth. A Bitcoin Core wallet accessible via <code>bitcoin-cli</code> command line tools, and a BDK wallet maintained by BDK library.</p> <p>But unlike other tutorials, we won't be using <code>bitcoin-cli</code> to talk to the Core wallet (we can, but let's spice things up). Instead, we will use the <code>bitcoin-rpc</code> library, to talk with our core node listening at <code>127.0.0.1:18443</code>, from inside our main function. This will allow us to write code, that will handle both the core and BDK wallet, from inside of the same function, and we won't have to switch terminals!</p> <p>Remember we imported <code>use bdk::bitcoincore_rpc::{Auth as rpc_auth, Client, RpcApi};</code>? Thats exactly for this purpose.</p> <p>Start the <code>bitcoind</code> node.</p> <p>you should see bitcoind listening at port 18443</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">sudo</span> <span class="token function">netstat</span> -nptl <span class="token operator">|</span> <span class="token function">grep</span> <span class="token number">18443</span> 
tcp        <span class="token number">0</span>      <span class="token number">0</span> <span class="token number">0.0</span>.0.0:18443           <span class="token number">0.0</span>.0.0:*               LISTEN      <span class="token number">135532</span>/bitcoind 
</code></pre></div><p>Lets create a core rpc interface in our main function.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">...</span>
    
    <span class="token comment">// Create a RPC interface</span>
    <span class="token keyword">let</span> rpc_auth <span class="token operator">=</span> <span class="token namespace">rpc_auth<span class="token punctuation">::</span></span><span class="token class-name">UserPass</span><span class="token punctuation">(</span>
        <span class="token string">&quot;admin&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;password&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">let</span> core_rpc <span class="token operator">=</span> <span class="token class-name">Client</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:18443/wallet/test&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rpc_auth<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{:#?}&quot;</span><span class="token punctuation">,</span> core_rpc<span class="token punctuation">.</span><span class="token function">get_blockchain_info</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>We have provided our RPC authentication <code>username</code> and <code>password</code> (same as provided in <code>bitcoin.conf</code> file).
We have provided the RPC address of our local bitcoin node, with the path to a wallet file, named <code>test</code>. And then asked the rpc client to give us the current blockchain info.
If everything goes well, running <code>cargo run</code> you should see an output like below:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ cargo run
<span class="token punctuation">..</span>.
GetBlockchainInfoResult <span class="token punctuation">{</span>
    chain: <span class="token string">&quot;regtest&quot;</span>,
    blocks: <span class="token number">0</span>,
    headers: <span class="token number">0</span>,
    best_block_hash: 0f9188f13cb7b2c71f2a335e3a4fc328bf5beb436012afca590b1a11466e2206,
    difficulty: <span class="token number">0.00000000046565423739069247</span>,
    median_time: <span class="token number">1296688602</span>,
    verification_progress: <span class="token number">1.0</span>,
    initial_block_download: true,
    <span class="token punctuation">..</span>.
</code></pre></div><p>Thats it. Now we can programmatically talk to our core node.</p> <h2 id="get-some-balance-in-core-wallet"><a href="#get-some-balance-in-core-wallet" class="header-anchor">#</a> Get some balance in core wallet.</h2> <p>We have told our rpc client that we would use a wallet named <code>test</code>. But currently, our core node doesn't have such a wallet. So let's create the wallet and fund it with some test coins.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">...</span>

    <span class="token comment">// Create the test wallet </span>
    core_rpc<span class="token punctuation">.</span><span class="token function">create_wallet</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Get a new address</span>
    <span class="token keyword">let</span> core_address <span class="token operator">=</span> core_rpc<span class="token punctuation">.</span><span class="token function">get_new_address</span><span class="token punctuation">(</span><span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Generate 101 blocks and use the above address as coinbase</span>
    core_rpc<span class="token punctuation">.</span><span class="token function">generate_to_address</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>core_address<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// fetch the new balance</span>
    <span class="token keyword">let</span> core_balance <span class="token operator">=</span> core_rpc<span class="token punctuation">.</span><span class="token function">get_balance</span><span class="token punctuation">(</span><span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Show balance</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;core balance: {:#?}&quot;</span><span class="token punctuation">,</span> core_balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This will create a wallet in bitcoin core named <code>test</code>. generate 101 blocks and use a new address from the wallet as coinbase wallet. Because required coinbase maturity in bitcoin is 100 blocks, by generating 101 blocks, we will have the balance of the first coinbase block reward available for use.
The last <code>println!()</code> statement will show the new updated balance as 50 BTC.</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ cargo run
<span class="token punctuation">..</span>.
core balance: Amount<span class="token punctuation">(</span><span class="token number">50.00000000</span> BTC<span class="token punctuation">)</span>       
</code></pre></div><p>Great! We now have 50 regtest BTC to play with.</p> <h2 id="setup-the-bdk-wallet"><a href="#setup-the-bdk-wallet" class="header-anchor">#</a> Setup the BDK wallet</h2> <p>Now that we are done setting up the core wallet. The last remaining step is to setup the BDK wallet. For this we will use the previous descriptor generation function and write code as below.</p> <p><strong>Note</strong>: You might want to comment out the previous code in <code>main()</code>, as running them again will create more coins in core, which isn't an issue, but might be confusing.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">...</span>

    <span class="token comment">// Get receive and change descriptor</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>receive_desc<span class="token punctuation">,</span> change_desc<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">get_descriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Use deterministic wallet name derived from descriptor</span>
    <span class="token keyword">let</span> wallet_name <span class="token operator">=</span> <span class="token function">wallet_name_from_descriptor</span><span class="token punctuation">(</span>
        <span class="token operator">&amp;</span>receive_desc<span class="token punctuation">,</span>
        <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>change_desc<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Network</span><span class="token punctuation">::</span><span class="token class-name">Regtest</span><span class="token punctuation">,</span>
        <span class="token operator">&amp;</span><span class="token class-name">Secp256k1</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Create the datadir to store wallet data</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> datadir <span class="token operator">=</span> <span class="token namespace">dirs_next<span class="token punctuation">::</span></span><span class="token function">home_dir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    datadir<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;.bdk-example&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> database <span class="token operator">=</span> <span class="token namespace">sled<span class="token punctuation">::</span></span><span class="token function">open</span><span class="token punctuation">(</span>datadir<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> db_tree <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">open_tree</span><span class="token punctuation">(</span>wallet_name<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Set RPC username, password and url</span>
    <span class="token keyword">let</span> auth <span class="token operator">=</span> <span class="token class-name">Auth</span><span class="token punctuation">::</span><span class="token class-name">UserPass</span> <span class="token punctuation">{</span>
        username<span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        password<span class="token punctuation">:</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> rpc_url <span class="token operator">=</span> <span class="token string">&quot;http://&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    rpc_url<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:18443&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Setup the RPC configuration</span>
    <span class="token keyword">let</span> rpc_config <span class="token operator">=</span> <span class="token class-name">RpcConfig</span> <span class="token punctuation">{</span>
        url<span class="token punctuation">:</span> rpc_url<span class="token punctuation">,</span>
        auth<span class="token punctuation">,</span>
        network<span class="token punctuation">:</span> <span class="token class-name">Network</span><span class="token punctuation">::</span><span class="token class-name">Regtest</span><span class="token punctuation">,</span>
        wallet_name<span class="token punctuation">,</span>
        skip_blocks<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// Use the above configuration to create a RPC blockchain backend</span>
    <span class="token keyword">let</span> blockchain <span class="token operator">=</span> <span class="token class-name">RpcBlockchain</span><span class="token punctuation">::</span><span class="token function">from_config</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rpc_config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Combine everything and finally create the BDK wallet structure</span>
    <span class="token keyword">let</span> wallet <span class="token operator">=</span> <span class="token class-name">Wallet</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>receive_desc<span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>change_desc<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Network</span><span class="token punctuation">::</span><span class="token class-name">Regtest</span><span class="token punctuation">,</span> db_tree<span class="token punctuation">,</span> blockchain<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Sync the wallet</span>
    wallet<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token class-name">NoopProgress</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Fetch a fresh address to receive coins</span>
    <span class="token keyword">let</span> address <span class="token operator">=</span> wallet<span class="token punctuation">.</span><span class="token function">get_address</span><span class="token punctuation">(</span><span class="token class-name">AddressIndex</span><span class="token punctuation">::</span><span class="token class-name">New</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>address<span class="token punctuation">;</span>

    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;bdk address: {:#?}&quot;</span><span class="token punctuation">,</span> address<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>That's a lot of code. They are divided into logical sections. Let's discuss each step one by one.</p> <ul><li>First we used our previous <code>get_descriptors()</code> function to generate two descriptor strings. One for generating receive addresses and one for change addresses.</li> <li>Then we used a special function from BDK called <code>wallet_name_from_descriptor()</code> to derive a name of the wallet from our descriptors. This allows us to have wallet names deterministically linked with descriptors. So in future if we use a different descriptor, the wallet will automatically have a different name. This allows us to not mix wallet names with same descriptor, and given the descriptors we can always determine what was the name we used. It is recommended to derive wallet names like this while using a core backend. Note that this wallet will be created inside the core node. So just like we accessed the <code>test</code> wallet, we could also access this wallet.</li> <li>Then we created a data directory at path <code>/home/username/.bdk-example</code>. We use <code>dirs_next</code> to find our home path, and then appended that with <code>.bdk-example</code>. All the BDK wallet files will be created and maintained in that directory. In the Database we instructed BDK to create a new <code>Tree</code> with <code>wallet_name</code>, so given a descriptor, BDK will always know which DB Tree to refer (<code>Tree</code> is a <code>sled</code> specific term).</li> <li>Then like we did previously, we created the rpc username/password authentication, and specified the rpc url. Note that we cannot use the same <code>rpc_auth</code> we used before for <code>core_rpc</code> as BDK auth and bitcoin-rpc auth are slightly separate structures.</li> <li>We combined all this information and created an <code>RpcConfig</code> structure.</li> <li>We used the rpc configuration to create a <code>RpcBlockchain</code> structure.</li> <li>Finally we used the Descriptors, Database, and Blockchain to create our final BDK <code>wallet</code> structure.</li></ul> <p>Now that we have a our wallet cooked, in the end, we instructed it to sync with the bitcoin core backend, and fetch us a new address.</p> <p>If all goes well, you should see an address printed in the terminal.</p> <div class="language-shell extra-class"><pre class="language-shell"><code>cargo run
    Finished dev <span class="token punctuation">[</span>unoptimized + debuginfo<span class="token punctuation">]</span> target<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">2</span>.99s
    Running <span class="token variable"><span class="token variable">`</span>target/debug/bdk-example<span class="token variable">`</span></span>
bdk address: bcrt1q9vkmujggvzs0rd4z6069v3v0jucje7ua7ap308
</code></pre></div><h2 id="sending-sats-around"><a href="#sending-sats-around" class="header-anchor">#</a> Sending Sats Around</h2> <p>Now that we have covered all the groundwork, we have all we need to send coins back and forth between core and BDK wallet.</p> <p>We will keep things simple here and make the following actions</p> <ul><li>Send 10 BTC from Core to BDK</li> <li>Send back 5 BTC from BDK to Core</li> <li>Display balance of two wallets</li></ul> <p>In the last line of previous section we got a new address from BDK wallet. We will start from there. Without further discussion lets jump straight into code.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">...</span>

    <span class="token comment">// Fetch a fresh address to receive coins</span>
    <span class="token keyword">let</span> address <span class="token operator">=</span> wallet<span class="token punctuation">.</span><span class="token function">get_address</span><span class="token punctuation">(</span><span class="token class-name">AddressIndex</span><span class="token punctuation">::</span><span class="token class-name">New</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>address<span class="token punctuation">;</span>

    <span class="token comment">// Send 10 BTC from Core to BDK</span>
    core_rpc<span class="token punctuation">.</span><span class="token function">send_to_address</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>address<span class="token punctuation">,</span> <span class="token class-name">Amount</span><span class="token punctuation">::</span><span class="token function">from_btc</span><span class="token punctuation">(</span><span class="token number">10.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Confirm transaction by generating some blocks</span>
    core_rpc<span class="token punctuation">.</span><span class="token function">generate_to_address</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>core_address<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Sync the BDK wallet</span>
    wallet<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token class-name">NoopProgress</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Create a transaction builder</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> tx_builder <span class="token operator">=</span> wallet<span class="token punctuation">.</span><span class="token function">build_tx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Set recipient of the transaction</span>
    tx_builder<span class="token punctuation">.</span><span class="token function">set_recipients</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">(</span><span class="token punctuation">(</span>core_address<span class="token punctuation">.</span><span class="token function">script_pubkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Finalise the transaction and extract PSBT</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token keyword">mut</span> psbt<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=</span> tx_builder<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Set signing option</span>
    <span class="token keyword">let</span> signopt <span class="token operator">=</span> <span class="token class-name">SignOptions</span> <span class="token punctuation">{</span>
        assume_height<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
        <span class="token punctuation">..</span><span class="token class-name">Default</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// Sign the above psbt with signing option</span>
    wallet<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> psbt<span class="token punctuation">,</span> signopt<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Extract the final transaction</span>
    <span class="token keyword">let</span> tx <span class="token operator">=</span> psbt<span class="token punctuation">.</span><span class="token function">extract_tx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Broadcast the transaction</span>
    wallet<span class="token punctuation">.</span><span class="token function">broadcast</span><span class="token punctuation">(</span>tx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Confirm transaction by generating some blocks</span>
    core_rpc<span class="token punctuation">.</span><span class="token function">generate_to_address</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>core_address<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Sync the BDK wallet</span>
    wallet<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token class-name">NoopProgress</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Fetch and display wallet balances</span>
    <span class="token keyword">let</span> core_balance <span class="token operator">=</span> core_rpc<span class="token punctuation">.</span><span class="token function">get_balance</span><span class="token punctuation">(</span><span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> bdk_balance <span class="token operator">=</span> <span class="token class-name">Amount</span><span class="token punctuation">::</span><span class="token function">from_sat</span><span class="token punctuation">(</span>wallet<span class="token punctuation">.</span><span class="token function">get_balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;core wallet balance: {:#?}&quot;</span><span class="token punctuation">,</span> core_balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;BDK wallet balance: {:#?}&quot;</span><span class="token punctuation">,</span> bdk_balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>The above code segment is mostly straight forward. The only new thing added is <code>wallet.build_tx()</code> which returns a <code>TxBuilder</code>. BDK allows us to have very fine grained control of cooking up transactions. Almost everything that is possible to do with a Bitcoin transaction can be done in BDK. Here we have a very simple vanilla transaction with no added magic. To get full list of capabilities that <code>TxBuilder</code> supports scour its implementation <a href="https://github.com/bitcoindevkit/bdk/blob/38d1d0b0e29d38cd370c740d798d96a3c9fcaa1f/src/wallet/tx_builder.rs#L123-L153" target="_blank" rel="noopener noreferrer">here<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p> <p>Finally to step through what we did above:</p> <ul><li>We asked core wallet to send 10 BTC to bdk wallet address.</li> <li>We confirmed the transaction, and synced the wallet.</li> <li>We asked BDK to create a transaction sending 5 BTC to core wallet address.</li> <li>We signed and broadcast the transaction. BDK will use the same core node to broadcast the transaction to network.</li> <li>We confirmed the transaction by mining a block, and synced the wallet.</li> <li>We fetched and displayed balance of both core and BDK wallet.</li></ul> <p>If all goes well, you should see the final updated balance as below:</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ cargo run
    Compiling bdk-example v0.1.0 <span class="token punctuation">(</span>/home/raj/github-repo/bdk-example/bdk-example<span class="token punctuation">)</span>
    Finished dev <span class="token punctuation">[</span>unoptimized + debuginfo<span class="token punctuation">]</span> target<span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token keyword">in</span> <span class="token number">3</span>.57s
    Running <span class="token variable"><span class="token variable">`</span>target/debug/bdk-example<span class="token variable">`</span></span>
core wallet balance: Amount<span class="token punctuation">(</span><span class="token number">144.99998590</span> BTC<span class="token punctuation">)</span>
BDK wallet balance: Amount<span class="token punctuation">(</span><span class="token number">4.99999859</span> BTC<span class="token punctuation">)</span>
</code></pre></div><p>Voila! We have ~145 BTC (150 - 5) in core wallet and 5 BTC (10 - 5) in BDK wallet. The slight deficiency in the amount are due to transaction fees. Because we are using regtest, the fee is some standard value hardcoded in core node.</p> <p>Check out the data directory where BDK has created the wallet data files.</p> <div class="language-shell extra-class"><pre class="language-shell"><code>$ <span class="token function">ls</span> ~/.bdk-example/
blobs  conf  db  snap.0000000000023CAB
</code></pre></div><p>And finally, this is what the final <code>main.rs</code> file looks like.</p> <div class="language-rust extra-class"><pre class="language-rust"><code><span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>bitcoin<span class="token punctuation">::</span></span><span class="token class-name">Network</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>bitcoin<span class="token punctuation">::</span>secp256k1<span class="token punctuation">::</span></span><span class="token class-name">Secp256k1</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>bitcoin<span class="token punctuation">::</span>util<span class="token punctuation">::</span>bip32<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">DerivationPath</span><span class="token punctuation">,</span> <span class="token class-name">KeySource</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>bitcoin<span class="token punctuation">::</span></span><span class="token class-name">Amount</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>bitcoincore_rpc<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Auth</span> <span class="token keyword">as</span> rpc_auth<span class="token punctuation">,</span> <span class="token class-name">Client</span><span class="token punctuation">,</span> <span class="token class-name">RpcApi</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>blockchain<span class="token punctuation">::</span>rpc<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Auth</span><span class="token punctuation">,</span> <span class="token class-name">RpcBlockchain</span><span class="token punctuation">,</span> <span class="token class-name">RpcConfig</span><span class="token punctuation">,</span> wallet_name_from_descriptor<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>blockchain<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">ConfigurableBlockchain</span><span class="token punctuation">,</span> <span class="token class-name">NoopProgress</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>keys<span class="token punctuation">::</span>bip39<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">Mnemonic</span><span class="token punctuation">,</span> <span class="token class-name">Language</span><span class="token punctuation">,</span> <span class="token class-name">MnemonicType</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>keys<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">GeneratedKey</span><span class="token punctuation">,</span> <span class="token class-name">GeneratableKey</span><span class="token punctuation">,</span> <span class="token class-name">ExtendedKey</span><span class="token punctuation">,</span> <span class="token class-name">DerivableKey</span><span class="token punctuation">,</span> <span class="token class-name">DescriptorKey</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>keys<span class="token punctuation">::</span></span><span class="token class-name">DescriptorKey</span><span class="token punctuation">::</span><span class="token class-name">Secret</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>miniscript<span class="token punctuation">::</span>miniscript<span class="token punctuation">::</span></span><span class="token class-name">Segwitv0</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span></span><span class="token class-name">Wallet</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span>wallet<span class="token punctuation">::</span></span><span class="token punctuation">{</span><span class="token class-name">AddressIndex</span><span class="token punctuation">,</span> <span class="token namespace">signer<span class="token punctuation">::</span></span><span class="token class-name">SignOptions</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">bdk<span class="token punctuation">::</span></span>sled<span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token namespace">std<span class="token punctuation">::</span></span><span class="token keyword">str</span><span class="token punctuation">::</span><span class="token class-name">FromStr</span><span class="token punctuation">;</span>

<span class="token keyword">fn</span> <span class="token function-definition function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create a RPC interface</span>
    <span class="token keyword">let</span> rpc_auth <span class="token operator">=</span> <span class="token namespace">rpc_auth<span class="token punctuation">::</span></span><span class="token class-name">UserPass</span><span class="token punctuation">(</span>
        <span class="token string">&quot;admin&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token string">&quot;password&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">let</span> core_rpc <span class="token operator">=</span> <span class="token class-name">Client</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token string">&quot;http://127.0.0.1:18443/wallet/test&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> rpc_auth<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Create the test wallet </span>
    core_rpc<span class="token punctuation">.</span><span class="token function">create_wallet</span><span class="token punctuation">(</span><span class="token string">&quot;test&quot;</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Get a new address</span>
    <span class="token keyword">let</span> core_address <span class="token operator">=</span> core_rpc<span class="token punctuation">.</span><span class="token function">get_new_address</span><span class="token punctuation">(</span><span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Generate 101 blocks and use the above address as coinbase</span>
    core_rpc<span class="token punctuation">.</span><span class="token function">generate_to_address</span><span class="token punctuation">(</span><span class="token number">101</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>core_address<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Get receive and change descriptor</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span>receive_desc<span class="token punctuation">,</span> change_desc<span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token function">get_descriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// Use deterministic wallet name derived from descriptor</span>
    <span class="token keyword">let</span> wallet_name <span class="token operator">=</span> <span class="token function">wallet_name_from_descriptor</span><span class="token punctuation">(</span>
        <span class="token operator">&amp;</span>receive_desc<span class="token punctuation">,</span>
        <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>change_desc<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token class-name">Network</span><span class="token punctuation">::</span><span class="token class-name">Regtest</span><span class="token punctuation">,</span>
        <span class="token operator">&amp;</span><span class="token class-name">Secp256k1</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Create the datadir to store wallet data</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> datadir <span class="token operator">=</span> <span class="token namespace">dirs_next<span class="token punctuation">::</span></span><span class="token function">home_dir</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    datadir<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token string">&quot;.bdk-example&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> database <span class="token operator">=</span> <span class="token namespace">sled<span class="token punctuation">::</span></span><span class="token function">open</span><span class="token punctuation">(</span>datadir<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> db_tree <span class="token operator">=</span> database<span class="token punctuation">.</span><span class="token function">open_tree</span><span class="token punctuation">(</span>wallet_name<span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Set RPC username and password</span>
    <span class="token keyword">let</span> auth <span class="token operator">=</span> <span class="token class-name">Auth</span><span class="token punctuation">::</span><span class="token class-name">UserPass</span> <span class="token punctuation">{</span>
        username<span class="token punctuation">:</span> <span class="token string">&quot;admin&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        password<span class="token punctuation">:</span> <span class="token string">&quot;password&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// Set RPC url</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> rpc_url <span class="token operator">=</span> <span class="token string">&quot;http://&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    rpc_url<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">&quot;127.0.0.1:18443&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Setup the RPC configuration</span>
    <span class="token keyword">let</span> rpc_config <span class="token operator">=</span> <span class="token class-name">RpcConfig</span> <span class="token punctuation">{</span>
        url<span class="token punctuation">:</span> rpc_url<span class="token punctuation">,</span>
        auth<span class="token punctuation">,</span>
        network<span class="token punctuation">:</span> <span class="token class-name">Network</span><span class="token punctuation">::</span><span class="token class-name">Regtest</span><span class="token punctuation">,</span>
        wallet_name<span class="token punctuation">,</span>
        skip_blocks<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// Use the above configuration to create a RPC blockchain backend</span>
    <span class="token keyword">let</span> blockchain <span class="token operator">=</span> <span class="token class-name">RpcBlockchain</span><span class="token punctuation">::</span><span class="token function">from_config</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>rpc_config<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Combine everything and finally create the BDK wallet structure</span>
    <span class="token keyword">let</span> wallet <span class="token operator">=</span> <span class="token class-name">Wallet</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>receive_desc<span class="token punctuation">,</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>change_desc<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Network</span><span class="token punctuation">::</span><span class="token class-name">Regtest</span><span class="token punctuation">,</span> db_tree<span class="token punctuation">,</span> blockchain<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Sync the wallet</span>
    wallet<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token class-name">NoopProgress</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Fetch a fresh address to receive coins</span>
    <span class="token keyword">let</span> address <span class="token operator">=</span> wallet<span class="token punctuation">.</span><span class="token function">get_address</span><span class="token punctuation">(</span><span class="token class-name">AddressIndex</span><span class="token punctuation">::</span><span class="token class-name">New</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>address<span class="token punctuation">;</span>

    <span class="token comment">// Send 10 BTC from Core to BDK</span>
    core_rpc<span class="token punctuation">.</span><span class="token function">send_to_address</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>address<span class="token punctuation">,</span> <span class="token class-name">Amount</span><span class="token punctuation">::</span><span class="token function">from_btc</span><span class="token punctuation">(</span><span class="token number">10.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Confirm transaction by generating some blocks</span>
    core_rpc<span class="token punctuation">.</span><span class="token function">generate_to_address</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>core_address<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Sync the BDK wallet</span>
    wallet<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token class-name">NoopProgress</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Create a transaction builder</span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> tx_builder <span class="token operator">=</span> wallet<span class="token punctuation">.</span><span class="token function">build_tx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Set recipient of the transaction</span>
    tx_builder<span class="token punctuation">.</span><span class="token function">set_recipients</span><span class="token punctuation">(</span><span class="token macro property">vec!</span><span class="token punctuation">(</span><span class="token punctuation">(</span>core_address<span class="token punctuation">.</span><span class="token function">script_pubkey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500000000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Finalise the transaction and extract PSBT</span>
    <span class="token keyword">let</span> <span class="token punctuation">(</span><span class="token keyword">mut</span> psbt<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=</span> tx_builder<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Set signing option</span>
    <span class="token keyword">let</span> signopt <span class="token operator">=</span> <span class="token class-name">SignOptions</span> <span class="token punctuation">{</span>
        assume_height<span class="token punctuation">:</span> <span class="token class-name">None</span><span class="token punctuation">,</span>
        <span class="token punctuation">..</span><span class="token class-name">Default</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment">// Sign the above psbt with signing option</span>
    wallet<span class="token punctuation">.</span><span class="token function">sign</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token keyword">mut</span> psbt<span class="token punctuation">,</span> signopt<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Extract the final transaction</span>
    <span class="token keyword">let</span> tx <span class="token operator">=</span> psbt<span class="token punctuation">.</span><span class="token function">extract_tx</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Broadcast the transaction</span>
    wallet<span class="token punctuation">.</span><span class="token function">broadcast</span><span class="token punctuation">(</span>tx<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Confirm transaction by generating some blocks</span>
    core_rpc<span class="token punctuation">.</span><span class="token function">generate_to_address</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token operator">&amp;</span>core_address<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Sync the BDK wallet</span>
    wallet<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token class-name">NoopProgress</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Fetch and display wallet balances</span>
    <span class="token keyword">let</span> core_balance <span class="token operator">=</span> core_rpc<span class="token punctuation">.</span><span class="token function">get_balance</span><span class="token punctuation">(</span><span class="token class-name">None</span><span class="token punctuation">,</span> <span class="token class-name">None</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> bdk_balance <span class="token operator">=</span> <span class="token class-name">Amount</span><span class="token punctuation">::</span><span class="token function">from_sat</span><span class="token punctuation">(</span>wallet<span class="token punctuation">.</span><span class="token function">get_balance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;core wallet balance: {:#?}&quot;</span><span class="token punctuation">,</span> core_balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;BDK wallet balance: {:#?}&quot;</span><span class="token punctuation">,</span> bdk_balance<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// generate fresh descriptor strings and return them via (receive, change) tupple </span>
<span class="token keyword">fn</span> <span class="token function-definition function">get_descriptors</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">-&gt;</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Create a new secp context</span>
    <span class="token keyword">let</span> secp <span class="token operator">=</span> <span class="token class-name">Secp256k1</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// You can also set a password to unlock the mnemonic</span>
    <span class="token keyword">let</span> password <span class="token operator">=</span> <span class="token class-name">Some</span><span class="token punctuation">(</span><span class="token string">&quot;random password&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Generate a fresh menmonic, and from their, a fresh private key xprv</span>
    <span class="token keyword">let</span> mnemonic<span class="token punctuation">:</span> <span class="token class-name">GeneratedKey</span><span class="token operator">&lt;</span>_<span class="token punctuation">,</span> <span class="token class-name">Segwitv0</span><span class="token operator">&gt;</span> <span class="token operator">=</span>
                <span class="token class-name">Mnemonic</span><span class="token punctuation">::</span><span class="token function">generate</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">MnemonicType</span><span class="token punctuation">::</span><span class="token class-name">Words12</span><span class="token punctuation">,</span> <span class="token class-name">Language</span><span class="token punctuation">::</span><span class="token class-name">English</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> mnemonic <span class="token operator">=</span> mnemonic<span class="token punctuation">.</span><span class="token function">into_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> xkey<span class="token punctuation">:</span> <span class="token class-name">ExtendedKey</span> <span class="token operator">=</span> <span class="token punctuation">(</span>mnemonic<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">into_extended_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> xprv <span class="token operator">=</span> xkey<span class="token punctuation">.</span><span class="token function">into_xprv</span><span class="token punctuation">(</span><span class="token class-name">Network</span><span class="token punctuation">::</span><span class="token class-name">Regtest</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Derive our dewscriptors to use</span>
    <span class="token comment">// We use the following paths for recieve and change descriptor</span>
    <span class="token comment">// recieve: &quot;m/84h/1h/0h/0&quot;</span>
    <span class="token comment">// change: &quot;m/84h/1h/0h/1&quot; </span>
    <span class="token keyword">let</span> <span class="token keyword">mut</span> keys <span class="token operator">=</span> <span class="token class-name">Vec</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> path <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">&quot;m/84h/1h/0h/0&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;m/84h/1h/0h/1&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> deriv_path<span class="token punctuation">:</span> <span class="token class-name">DerivationPath</span> <span class="token operator">=</span> <span class="token class-name">DerivationPath</span><span class="token punctuation">::</span><span class="token function">from_str</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> derived_xprv <span class="token operator">=</span> <span class="token operator">&amp;</span>xprv<span class="token punctuation">.</span><span class="token function">derive_priv</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>secp<span class="token punctuation">,</span> <span class="token operator">&amp;</span>deriv_path<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> origin<span class="token punctuation">:</span> <span class="token class-name">KeySource</span> <span class="token operator">=</span> <span class="token punctuation">(</span>xprv<span class="token punctuation">.</span><span class="token function">fingerprint</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>secp<span class="token punctuation">)</span><span class="token punctuation">,</span> deriv_path<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">let</span> derived_xprv_desc_key<span class="token punctuation">:</span> <span class="token class-name">DescriptorKey</span><span class="token operator">&lt;</span><span class="token class-name">Segwitv0</span><span class="token operator">&gt;</span> <span class="token operator">=</span>
        derived_xprv<span class="token punctuation">.</span><span class="token function">into_descriptor_key</span><span class="token punctuation">(</span><span class="token class-name">Some</span><span class="token punctuation">(</span>origin<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">DerivationPath</span><span class="token punctuation">::</span><span class="token function">default</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">unwrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">// Wrap the derived key with the wpkh() string to produce a descriptor string</span>
        <span class="token keyword">if</span> <span class="token keyword">let</span> <span class="token class-name">Secret</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> _<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token operator">=</span> derived_xprv_desc_key <span class="token punctuation">{</span>
            <span class="token keyword">let</span> <span class="token keyword">mut</span> desc <span class="token operator">=</span> <span class="token string">&quot;wpkh(&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            desc<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>key<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            desc<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">&quot;)&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>desc<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    
    <span class="token comment">// Return the keys as a tupple</span>
    <span class="token punctuation">(</span>keys<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> keys<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="conclusion"><a href="#conclusion" class="header-anchor">#</a> Conclusion</h2> <p>In this tutorial we saw some very basic BDK wallet functionality with a bitcoin core backend as the source and sync of blockchain data. This is just tip of the iceberg of BDK capabilities. BDK allows flexibility in all the dimensions of a bitcoin wallet, that is key chain, blockchain backend and database management. With all that power, we just implemented a trustless, non-custodial, private bitcoin wallet, backed by a bitcoin full node, with less than 200 lines of code (including lots of comments).</p> <p>BDK thus allows wallet devs, to only focus on stuff that they care about, writing wallet logic. All the backend stuff like blockchain, key management, and databases are abstracted away under the hood.</p> <p>To find and explore more about the BDK capabilities and how it can fit your development need refer the following resources.</p> <ul><li><a href="https://github.com/bitcoindevkit/bdk" target="_blank" rel="noopener noreferrer">source code<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.rs/bdk/0.10.0/bdk/" target="_blank" rel="noopener noreferrer">dev docs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://discord.com/invite/d7NkDKm" target="_blank" rel="noopener noreferrer">community<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/bitcoindevkit/bitcoindevkit.org/edit/master/docs/tutorials/Bitcoin_Core_RPC_Demo.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/14/2022, 5:18:24 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/2020/12/hello-world/" class="prev">
        Hello World!
      </a></span> <span class="next"><a href="/tutorials/compact_filters_demo/">
        BDK wallet as a BIP157 SPV light client
      </a>
      →
    </span></p></div> </main></div></div> <footer class="footer" data-v-9ca807bc><div class="wrap"><div class="wrap-border"><div class="inner"><div class="footer-content"><div class="footer-block"><h4>Docs</h4> <div><a href="/getting-started/" class="nav-link">
  Getting Started
</a></div><div><a href="/bdk-cli/installation/" class="nav-link">
  BDK-CLI
</a></div><div><a href="/descriptors/" class="nav-link">
  Descriptors
</a></div></div><div class="footer-block"><h4>Community</h4> <div><a href="https://github.com/bitcoindevkit" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div><a href="https://twitter.com/intent/follow?screen_name=bitcoindevkit" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Twitter
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div><a href="https://discord.gg/dstn4dQ" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Chat on Discord
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div></div><div class="footer-block"><h4>More</h4> <div><a href="/blog/" class="nav-link">
  Blog
</a></div><div><a href="/supporters/" class="nav-link">
  Supporters
</a></div></div></div> <p class="copyright">Copyright © 2022 BDK Developers</p></div></div></div></footer></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.d51c0966.js" defer></script><script src="/assets/js/9.e360c80b.js" defer></script><script src="/assets/js/1.2e1eea68.js" defer></script><script src="/assets/js/49.326245ce.js" defer></script>
  </body>
</html>
