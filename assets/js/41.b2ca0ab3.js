(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{460:function(t,e,a){"use strict";a.r(e);var s=a(18),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"regtest"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#regtest"}},[t._v("#")]),t._v(" Regtest")]),t._v(" "),a("p",[t._v("Running the "),a("code",[t._v("bdk-cli")]),t._v(" tool in regtest requires having a local Electrum server set-up. There are two main implementations, "),a("a",{attrs:{href:"https://github.com/romanz/electrs",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("electrs")]),a("OutboundLink")],1),t._v(" in Rust and "),a("a",{attrs:{href:"https://github.com/spesmilo/electrumx",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("ElectrumX")]),a("OutboundLink")],1),t._v(" in Python. Since the Rust toolchain is already required to\nuse BDK, this page will focus mostly on the former.")]),t._v(" "),a("p",[t._v("Electrs can be installed by running:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("cargo "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" --git https://github.com/romanz/electrs --bin electrs\n")])])]),a("p",[t._v("Just like before, this command will probably take a while to finish.")]),t._v(" "),a("p",[t._v("Once it's done, assuming you have a regtest bitcoind running in background, you can launch a new terminal and run the following command to actually start electrs:")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("electrs --log-filters INFO --timestamp --db-dir /tmp/electrs-db --electrum-rpc-addr"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.1:50001"')]),t._v(" --network"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("regtest --cookie-file"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$HOME")]),t._v("/.bitcoin/regtest/.cookie\n")])])]),a("p",[t._v("on macOS you should change the cookie-file to "),a("code",[t._v("$HOME/Library/Application Support/Bitcoin/regtest/.cookie")]),t._v(".")]),t._v(" "),a("p",[t._v("This will start the Electrum server on port 50001. You can then add the "),a("code",[t._v("-n regtest -s 127.0.0.1:50001")]),t._v(" to the "),a("code",[t._v("bdk-cli")]),t._v(" commands to switch to the local regtest.")]),t._v(" "),a("h2",{attrs:{id:"troubleshooting"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting"}},[t._v("#")]),t._v(" Troubleshooting")]),t._v(" "),a("h4",{attrs:{id:"stuck-with-wait-until-bitcoind-is-synced-ie-initialblockdownload-false-"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#stuck-with-wait-until-bitcoind-is-synced-ie-initialblockdownload-false-"}},[t._v("#")]),t._v(' Stuck with "'),a("em",[t._v("wait until bitcoind is synced (i.e. initialblockdownload = false)")]),t._v('"')]),t._v(" "),a("p",[t._v("Just generate a few blocks with "),a("code",[t._v("bitcoin-cli generatetoaddress 1 <address>")])]),t._v(" "),a("h2",{attrs:{id:"bonus-docker"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bonus-docker"}},[t._v("#")]),t._v(" Bonus: Docker")]),t._v(" "),a("p",[t._v("If you have already installed Docker on your machine, you can also use üç£ "),a("a",{attrs:{href:"https://github.com/vulpemventures/nigiri",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nigiri CLI"),a("OutboundLink")],1),t._v(" to spin-up a complete development environment in "),a("code",[t._v("regtest")]),t._v(" that includes a "),a("code",[t._v("bitcoin")]),t._v(" node, an "),a("code",[t._v("electrs")]),t._v(" explorer and the "),a("a",{attrs:{href:"https://github.com/blockstream/esplora",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("esplora")]),a("OutboundLink")],1),t._v(" web-app to visualize blocks and transactions in the browser.")]),t._v(" "),a("p",[t._v("Install üç£ Nigiri")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" https://getnigiri.vulpem.com "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v("\n")])])]),a("p",[t._v("Start Docker daemon and run Nigiri box")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("$ nigiri start\n")])])]),a("p",[t._v("This will start electrum RPC interface on port "),a("code",[t._v("51401")]),t._v(", the REST interface on "),a("code",[t._v("3000")]),t._v(" and the esplora UI on "),a("code",[t._v("5000")]),t._v(" (You can visit with the browser and look for blocks, addresses and transactions)")]),t._v(" "),a("p",[t._v("You can then add the "),a("code",[t._v("-n regtest -s 127.0.0.1:51401")]),t._v(" to the "),a("code",[t._v("bdk-cli")]),t._v(" commands to switch to the local regtest.")])])}),[],!1,null,null,null);e.default=r.exports}}]);