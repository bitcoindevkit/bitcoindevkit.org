(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{449:function(t,e,a){"use strict";a.r(e);var s=a(7),r=Object(s.a)({},(function(){var t=this,e=t._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"regtest"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#regtest"}},[t._v("#")]),t._v(" Regtest")]),t._v(" "),e("p",[t._v("Running the "),e("code",[t._v("bdk-cli")]),t._v(" tool in regtest requires having a local Electrum server set-up. There are two main implementations, "),e("a",{attrs:{href:"https://github.com/romanz/electrs",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("electrs")]),e("OutboundLink")],1),t._v(" in Rust and "),e("a",{attrs:{href:"https://github.com/spesmilo/electrumx",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("ElectrumX")]),e("OutboundLink")],1),t._v(" in Python. Since the Rust toolchain is already required to\nuse BDK, this page will focus mostly on the former.")]),t._v(" "),e("p",[t._v("Electrs can be installed by running:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cargo")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--git")]),t._v(" https://github.com/romanz/electrs "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--bin")]),t._v(" electrs\n")])])]),e("p",[t._v("Just like before, this command will probably take a while to finish.")]),t._v(" "),e("p",[t._v("Once it's done, assuming you have a regtest bitcoind running in background, you can launch a new terminal and run the following command to actually start electrs:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("electrs --log-filters INFO "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--timestamp")]),t._v(" --db-dir /tmp/electrs-db --electrum-rpc-addr"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"127.0.0.1:50001"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--network")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("regtest --cookie-file"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$HOME")]),t._v("/.bitcoin/regtest/.cookie\n")])])]),e("p",[t._v("on macOS you should change the cookie-file to "),e("code",[t._v("$HOME/Library/Application Support/Bitcoin/regtest/.cookie")]),t._v(".")]),t._v(" "),e("p",[t._v("This will start the Electrum server on port 50001. You can then add the "),e("code",[t._v("-n regtest -s 127.0.0.1:50001")]),t._v(" to the "),e("code",[t._v("bdk-cli")]),t._v(" commands to switch to the local regtest.")]),t._v(" "),e("h2",{attrs:{id:"troubleshooting"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#troubleshooting"}},[t._v("#")]),t._v(" Troubleshooting")]),t._v(" "),e("h4",{attrs:{id:"stuck-with-wait-until-bitcoind-is-synced-ie-initialblockdownload-false-"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#stuck-with-wait-until-bitcoind-is-synced-ie-initialblockdownload-false-"}},[t._v("#")]),t._v(' Stuck with "'),e("em",[t._v("wait until bitcoind is synced (i.e. initialblockdownload = false)")]),t._v('"')]),t._v(" "),e("p",[t._v("Just generate a few blocks with "),e("code",[t._v("bitcoin-cli generatetoaddress 1 <address>")])]),t._v(" "),e("h2",{attrs:{id:"bonus-docker"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#bonus-docker"}},[t._v("#")]),t._v(" Bonus: Docker")]),t._v(" "),e("p",[t._v("If you have already installed Docker on your machine, you can also use üç£ "),e("a",{attrs:{href:"https://github.com/vulpemventures/nigiri",target:"_blank",rel:"noopener noreferrer"}},[t._v("Nigiri CLI"),e("OutboundLink")],1),t._v(" to spin-up a complete development environment in "),e("code",[t._v("regtest")]),t._v(" that includes a "),e("code",[t._v("bitcoin")]),t._v(" node, an "),e("code",[t._v("electrs")]),t._v(" explorer and the "),e("a",{attrs:{href:"https://github.com/blockstream/esplora",target:"_blank",rel:"noopener noreferrer"}},[e("code",[t._v("esplora")]),e("OutboundLink")],1),t._v(" web-app to visualize blocks and transactions in the browser.")]),t._v(" "),e("p",[t._v("Install üç£ Nigiri")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[t._v("$ "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" https://getnigiri.vulpem.com "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("bash")]),t._v("\n")])])]),e("p",[t._v("Start Docker daemon and run Nigiri box")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("$ nigiri start\n")])])]),e("p",[t._v("This will start electrum RPC interface on port "),e("code",[t._v("51401")]),t._v(", the REST interface on "),e("code",[t._v("3000")]),t._v(" and the esplora UI on "),e("code",[t._v("5000")]),t._v(" (You can visit with the browser and look for blocks, addresses and transactions)")]),t._v(" "),e("p",[t._v("You can then add the "),e("code",[t._v("-n regtest -s 127.0.0.1:51401")]),t._v(" to the "),e("code",[t._v("bdk-cli")]),t._v(" commands to switch to the local regtest.")])])}),[],!1,null,null,null);e.default=r.exports}}]);