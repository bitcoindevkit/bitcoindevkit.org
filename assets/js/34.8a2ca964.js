(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{454:function(s,t,a){"use strict";a.r(t);var e=a(18),n=Object(e.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("In this post we will use the "),a("a",{attrs:{href:"https://github.com/bitcoindevkit/bdk-cli",target:"_blank",rel:"noopener noreferrer"}},[s._v("bdk-cli"),a("OutboundLink")],1),s._v(" tool to demonstrate how to use the "),a("a",{attrs:{href:"https://github.com/bitcoindevkit/bdk",target:"_blank",rel:"noopener noreferrer"}},[s._v("bdk"),a("OutboundLink")],1),s._v(" library to:")]),s._v(" "),a("ol",[a("li",[s._v("generate "),a("em",[s._v("testnet")]),s._v(" public and private keys")]),s._v(" "),a("li",[s._v("create "),a("a",{attrs:{href:"https://bitcoinops.org/en/topics/psbt/",target:"_blank",rel:"noopener noreferrer"}},[s._v("PSBT"),a("OutboundLink")],1),s._v("s that can be spent based on different "),a("a",{attrs:{href:"http://bitcoin.sipa.be/miniscript/",target:"_blank",rel:"noopener noreferrer"}},[s._v("miniscript spending policies"),a("OutboundLink")],1)]),s._v(" "),a("li",[s._v("cooperatively sign and finalize the resulting PSBTs")]),s._v(" "),a("li",[s._v("broadcast and confirm spending transactions")])]),s._v(" "),a("p",[s._v("The scenario we will simulate is a wallet with two spending policies:")]),s._v(" "),a("p",[s._v("A. "),a("strong",[s._v("three")]),s._v(" out of "),a("strong",[s._v("three")]),s._v(" signers must sign spending transaction input "),a("a",{attrs:{href:"https://developer.bitcoin.org/glossary.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("UTXO"),a("OutboundLink")],1),s._v("s, "),a("strong",[s._v("OR")])]),s._v(" "),a("p",[s._v("B. "),a("strong",[s._v("two")]),s._v(" out of "),a("strong",[s._v("three")]),s._v(" signers must sign "),a("strong",[s._v("AND")]),s._v(" the input UTXOs must be a relative number of blocks older than the spending transaction's block")]),s._v(" "),a("p",[s._v("In a real-world wallet a longer relative time-lock would probably be used, but we chose a two block time-lock to make testing easier.")]),s._v(" "),a("p",[a("em",[s._v("Note: If you repeat these instructions on your own your extended keys, addresses, and other values will be different than shown in this post, but the end results should be the same.")])]),s._v(" "),a("h2",{attrs:{id:"initial-setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#initial-setup"}},[s._v("#")]),s._v(" Initial Setup")]),s._v(" "),a("h3",{attrs:{id:"step-0-install-a-recent-version-bdk-cli"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-0-install-a-recent-version-bdk-cli"}},[s._v("#")]),s._v(" Step 0: Install a recent version "),a("code",[s._v("bdk-cli")])]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("cargo "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" bdk-cli --features repl,electrum,esplora\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# confirm bdk-cli is installed")]),s._v("\nbdk-cli --version\nBDK CLI "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.2")]),s._v(".0\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# bdk-cli usage can be explored with the `help` sub-command")]),s._v("\nbdk-cli "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("help")]),s._v("\n")])])]),a("h3",{attrs:{id:"step-1-generate-private-extended-keys"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-1-generate-private-extended-keys"}},[s._v("#")]),s._v(" Step 1: Generate private extended keys")]),s._v(" "),a("p",[s._v("Generate new extended private keys for each of our wallet participants:")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("bdk-cli key generate "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" alice-key.json\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fingerprint"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5adb4683"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mnemonic"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"witness poverty pulse crush era item game rose bargain quantum spawn sure way behave also basket journey worry stem entry toddler floor way bone"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xprv"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tprv8ZgxMBicQKsPeAuGznXJZwfWHgWo86dFuufRBZN7ZT44UzoNG2cYmZLNLrnsm7eXhGSeccRU2nTtxunT11UkpqrRhJQefBnFJeHBddF68bg"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nbdk-cli key generate "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" bob-key.json\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fingerprint"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5fdec309"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mnemonic"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"shiver atom february jealous spy gallery upset height captain snake tooth master ugly orbit amazing nice parrot elevator own olympic great relief ozone violin"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xprv"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tprv8ZgxMBicQKsPei56wJPNt9u2132Ynncp2qXdfSHszobnyjaGjQwxQBGASUidc1unmEmpyMQ9XzLgvbN36MDW7LNziVFdXVGMrx6ckMHuRmd"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nbdk-cli key generate "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" carol-key.json\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fingerprint"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"de41e56d"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mnemonic"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"upon bridge side tool style lounge need faculty middle nation armed corn valve that undo ribbon rent digital adapt capable embody zero shiver carpet"')]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"xprv"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tprv8ZgxMBicQKsPf2edJLnXsF2AKwkCshCy2Z7fQD6FxiNVGsbkvpLRfxM8FSKrLqqpLFzLzVUBwgE9F5MQASrbedKCrGk1NG8oJgqYtmTLQEU"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h3",{attrs:{id:"step-2-extract-private-extended-keys"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-2-extract-private-extended-keys"}},[s._v("#")]),s._v(" Step 2: Extract private extended keys")]),s._v(" "),a("p",[s._v("Here we use the "),a("code",[s._v("jq")]),s._v(" Unix command to parse the json output of the "),a("code",[s._v("bdk-cli")]),s._v(" commands.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALICE_XPRV")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" alice-key.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.xprv'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BOB_XPRV")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" bob-key.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.xprv'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CAROL_XPRV")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" carol-key.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'.xprv'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])])]),a("h3",{attrs:{id:"step-3-derive-public-extended-keys"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-3-derive-public-extended-keys"}},[s._v("#")]),s._v(" Step 3: Derive public extended keys")]),s._v(" "),a("p",[s._v("For this example we are using the "),a("a",{attrs:{href:"https://github.com/bitcoin/bips/blob/master/bip-0084.mediawiki",target:"_blank",rel:"noopener noreferrer"}},[s._v("BIP-84"),a("OutboundLink")],1),s._v(" key path: "),a("code",[s._v("m/84h/1h/0h/0/*")]),s._v(" to derive extended public keys to share with other wallet participants.")]),s._v(" "),a("p",[s._v("Note that the "),a("code",[s._v("key derive")]),s._v(" sub-command will generate a tpub for the last hardened node in the given derivation path. You'll also notice that "),a("code",[s._v("bdk-cli")]),s._v(" will returns our tpub with the key origin (fingerprint/path) added to it (the metadata part that looks like "),a("code",[s._v("[5adb4683/84'/1'/0']")]),s._v(" right before the tpub). This key origin information is not necessary in order to use a tpub and generate addresses, but it's good practice to include it because some signers require it.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALICE_XPUB")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("bdk-cli key derive --xprv $ALICE_XPRV --path "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"m/84'/1'/0'/0\"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".xpub"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_XPUB")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"[5adb4683/84'/1'/0']tpubDCyRBuncqwyAjSNiw1GWLmwQsWyhgPMEBpx3ZNpnCwZwf3HXerspTpaneN81KRxkwj8vjqH9pNWEPgNhen7dfE212SHfxBBbsCywxQGxvvu/0/*\"")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BOB_XPUB")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("bdk-cli key derive --xprv $BOB_XPRV --path "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"m/84'/1'/0'/0\"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".xpub"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BOB_XPUB")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"[5fdec309/84'/1'/0']tpubDDQcUeBH9JFtgZEsHZBhmRu8AuZ8ceJY1umnipPVEg1had2coGMCWdFBXNnZWKoCPic3EMgDZTdmkAVNoakwNZu2ESSW36rQvts6VXGx4bU/0/*\"")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CAROL_XPUB")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("bdk-cli key derive --xprv $CAROL_XPRV --path "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"m/84'/1'/0'/0\"")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".xpub"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v('"'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CAROL_XPUB")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v('"\n'),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("\"[de41e56d/84'/1'/0']tpubDCdxmvzJ5QBjTN8oCjjyT2V58AyZvA1fkmCeZRC75QMoaHcVP2m45Bv3hmnR7ttAwkb2UNYyoXdHVt4gwBqRrJqLUU2JrM43HippxiWpHra/0/*\"")]),s._v("\n")])])]),a("h3",{attrs:{id:"step-4-create-wallet-descriptors-for-each-participant"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-4-create-wallet-descriptors-for-each-participant"}},[s._v("#")]),s._v(" Step 4: Create wallet descriptors for each participant")]),s._v(" "),a("p",[s._v("We used the "),a("a",{attrs:{href:"https://bitcoindevkit.org/bdk-cli/playground/",target:"_blank",rel:"noopener noreferrer"}},[s._v("BDK Playground Policy Compiler"),a("OutboundLink")],1),s._v(" to compile the "),a("a",{attrs:{href:"http://bitcoin.sipa.be/miniscript/",target:"_blank",rel:"noopener noreferrer"}},[s._v("miniscript"),a("OutboundLink")],1),s._v(" policy:")]),s._v(" "),a("p",[a("code",[s._v("thresh(3,pk(Alice),pk(Bob),pk(Carol),older(2))")])]),s._v(" "),a("p",[s._v("To the "),a("a",{attrs:{href:"https://bitcoindevkit.org/descriptors/",target:"_blank",rel:"noopener noreferrer"}},[s._v("output descriptor"),a("OutboundLink")],1),s._v(":")]),s._v(" "),a("p",[a("code",[s._v("wsh(thresh(3,pk(Alice),s:pk(Bob),s:pk(Carol),sdv:older(2)))")])]),s._v(" "),a("p",[s._v("This descriptor requires spending transaction inputs must be signed by all three signers, or by two signers and the spent UTXOs must be older than two blocks.")]),s._v(" "),a("p",[s._v("Each participant's descriptor only uses their own XPRV key plus the XPUB keys of the other participants.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALICE_DESCRIPTOR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wsh(thresh(3,pk('),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_XPRV")]),s._v("/84'/1'/0'/0/*),s:pk("),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BOB_XPUB")]),s._v("),s:pk("),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CAROL_XPUB")]),s._v('),sdv:older(2)))"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BOB_DESCRIPTOR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wsh(thresh(3,pk('),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_XPUB")]),s._v("),s:pk("),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BOB_XPRV")]),s._v("/84'/1'/0'/0/*),s:pk("),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CAROL_XPUB")]),s._v('),sdv:older(2)))"')]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CAROL_DESCRIPTOR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"wsh(thresh(3,pk('),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_XPUB")]),s._v("),s:pk("),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BOB_XPUB")]),s._v("),s:pk("),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CAROL_XPRV")]),s._v("/84'/1'/0'/0/*),sdv:older(2)))\"")]),s._v("\n")])])]),a("h2",{attrs:{id:"policy-a-three-signatures"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#policy-a-three-signatures"}},[s._v("#")]),s._v(" Policy A. Three signatures")]),s._v(" "),a("h3",{attrs:{id:"step-1a-create-a-testnet-segwit0-receive-address"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-1a-create-a-testnet-segwit0-receive-address"}},[s._v("#")]),s._v(" Step 1a: Create a testnet "),a("a",{attrs:{href:"https://en.bitcoin.it/wiki/Segregated_Witness",target:"_blank",rel:"noopener noreferrer"}},[s._v("segwit0"),a("OutboundLink")],1),s._v(" receive address")]),s._v(" "),a("p",[s._v("This step can be done independently by Alice, Bob, or Carol.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("bdk-cli wallet -w carol -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CAROL_DESCRIPTOR")]),s._v(" get_new_address\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"address"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tb1qpqglt6yntay0se5vj3a7g36rql5pyzzp0w6jknfch2c0unwphsxs22g96e"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h3",{attrs:{id:"step-2a-send-testnet-bitcoin-from-a-faucet-to-receive-address"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-2a-send-testnet-bitcoin-from-a-faucet-to-receive-address"}},[s._v("#")]),s._v(" Step 2a: Send testnet bitcoin from a faucet to receive address")]),s._v(" "),a("p",[s._v("After a faucet payment is sent, use a testnet block explorer to confirm the transaction was included in a block.")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://mempool.space/testnet/address/tb1qpqglt6yntay0se5vj3a7g36rql5pyzzp0w6jknfch2c0unwphsxs22g96e",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://mempool.space/testnet/address/tb1qpqglt6yntay0se5vj3a7g36rql5pyzzp0w6jknfch2c0unwphsxs22g96e"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"step-3a-sync-participant-wallets-and-confirm-balance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-3a-sync-participant-wallets-and-confirm-balance"}},[s._v("#")]),s._v(" Step 3a: Sync participant wallets and confirm balance")]),s._v(" "),a("p",[s._v("This step must be done by Alice, Bob, and Carol so their individual descriptor wallets know about the faucet transaction they will later be spending the output of.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("bdk-cli wallet -w alice -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_DESCRIPTOR")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nbdk-cli wallet -w alice -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_DESCRIPTOR")]),s._v(" get_balance\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"satoshi"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nbdk-cli wallet -w bob -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BOB_DESCRIPTOR")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nbdk-cli wallet -w bob -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BOB_DESCRIPTOR")]),s._v(" get_balance\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"satoshi"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nbdk-cli wallet -w carol -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CAROL_DESCRIPTOR")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nbdk-cli wallet -w carol -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CAROL_DESCRIPTOR")]),s._v(" get_balance\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"satoshi"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h3",{attrs:{id:"step-4a-view-wallet-spending-policies"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-4a-view-wallet-spending-policies"}},[s._v("#")]),s._v(" Step 4a: View wallet spending policies")]),s._v(" "),a("p",[s._v("This can also be done by any wallet participant, as long as they have the same descriptor and extended public keys from the other particpants..")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("bdk-cli wallet -w alice -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_DESCRIPTOR")]),s._v(" policies\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"external"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"contribution"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"conditions"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"0"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"csv"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"items"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"m"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"n"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"PARTIAL"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ydtnup84"')]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"items"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"contribution"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"condition"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"COMPLETE"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fingerprint"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5adb4683"')]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"uyxvyzqt"')]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"satisfaction"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NONE"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SIGNATURE"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"contribution"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NONE"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fingerprint"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"5fdec309"')]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"dzkmxcgu"')]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"satisfaction"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NONE"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SIGNATURE"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"contribution"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NONE"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fingerprint"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"de41e56d"')]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"ekfu5uaw"')]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"satisfaction"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NONE"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"SIGNATURE"')]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"contribution"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"condition"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n            "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"csv"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"COMPLETE"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"id"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8kel7sdw"')]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"satisfaction"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n          "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NONE"')]),s._v("\n        "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"RELATIVETIMELOCK"')]),s._v(",\n        "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"value"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"satisfaction"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"NONE"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"threshold"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"type"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"THRESH"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"internal"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h3",{attrs:{id:"step-5a-create-spending-transaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-5a-create-spending-transaction"}},[s._v("#")]),s._v(" Step 5a: Create spending transaction")]),s._v(" "),a("p",[s._v("The transaction can also be created by Alice, Bob, or Carol, or even an untrusted coordinator that only has all three tpubs.")]),s._v(" "),a("p",[s._v("Note that the argument provided to the --external_policy flag contains the id retrieved from the "),a("code",[s._v("policies")]),s._v(" subcommand in the above step, in this case "),a("code",[s._v("ydtnup84")]),s._v(".")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("bdk-cli wallet -w alice -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_DESCRIPTOR")]),s._v(" create_tx -a --to tb1qm5tfegjevj27yvvna9elym9lnzcf0zraxgl8z2:0 --external_policy "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{'),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("ydtnup84"),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(': [0,1,2]}"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"details"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fees"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("169")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"height"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"received"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sent"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timestamp"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1614058791")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"transaction"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"txid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3b9a7ac610afc91f1d1a0dd844e609376278fe7210c69b7ef663c5a8e8308f3e"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"psbt"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cHNidP8BAFIBAAAAAYx7T0cL7EoUYBEU0mSL6+DS4VQafUzJgAf0Ftlbkya5AQAAAAD/////AWcmAAAAAAAAFgAU3RacollkleIxk+lz8my/mLCXiH0AAAAAAAEBKxAnAAAAAAAAIgAgCBH16JNfSPhmjJR75EdDB+gSCEF7tStNOLqw/k3BvA0BBXchA3c1Ak2kcGOzOh6eRXFKfpnpzP1lzfcXIYhxFGZG51mxrHwhA75YDXRLDLt+eX5UsE03mIGUSsQP2MrJ9lm17cGXDw2mrJN8IQIvNjaP+mwNC0DtgaB6ENB/DPPlbUDR6+NZ4Sw070jzOKyTfHZjUrJpaJNThyIGAi82No/6bA0LQO2BoHoQ0H8M8+VtQNHr41nhLDTvSPM4DO66tnIAAAAAAAAAACIGA3c1Ak2kcGOzOh6eRXFKfpnpzP1lzfcXIYhxFGZG51mxGFrbRoNUAACAAQAAgAAAAIAAAAAAAAAAACIGA75YDXRLDLt+eX5UsE03mIGUSsQP2MrJ9lm17cGXDw2mDEMxpeYAAAAAAAAAAAAA"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UNSIGNED_PSBT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("bdk-cli wallet -w alice -d $ALICE_DESCRIPTOR create_tx -a --to tb1qm5tfegjevj27yvvna9elym9lnzcf0zraxgl8z2:0 --external_policy "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{'),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("ydtnup84"),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(': [0,1,2]}"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".psbt"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])])]),a("h3",{attrs:{id:"step-6a-sign-and-finalize-psbts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-6a-sign-and-finalize-psbts"}},[s._v("#")]),s._v(" Step 6a: Sign and finalize PSBTs")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ALICE SIGNS")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALICE_SIGNED_PSBT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("bdk-cli wallet -w alice -d $ALICE_DESCRIPTOR sign --psbt $UNSIGNED_PSBT "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".psbt"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# BOB SIGNS")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALICE_BOB_SIGNED_PSBT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("bdk-cli wallet -w bob -d $BOB_DESCRIPTOR sign --psbt $ALICE_SIGNED_PSBT "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".psbt"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CAROL SIGNS")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("FINAL_PSBT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("bdk-cli wallet -w carol -d $CAROL_DESCRIPTOR sign --psbt $ALICE_BOB_SIGNED_PSBT "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".psbt"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("## PSBT is finalized")]),s._v("\nbdk-cli wallet -w carol -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CAROL_DESCRIPTOR")]),s._v(" sign --psbt "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_BOB_SIGNED_PSBT")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"is_finalized"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" true,\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"psbt"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cHNidP8BAFIBAAAAAYx7T0cL7EoUYBEU0mSL6+DS4VQafUzJgAf0Ftlbkya5AQAAAAD/////AWcmAAAAAAAAFgAU3RacollkleIxk+lz8my/mLCXiH0AAAAAAAEBKxAnAAAAAAAAIgAgCBH16JNfSPhmjJR75EdDB+gSCEF7tStNOLqw/k3BvA0iAgIvNjaP+mwNC0DtgaB6ENB/DPPlbUDR6+NZ4Sw070jzOEcwRAIgRPXSwFLfzD1YQzw5FGYA0TgiQ+D88hSOVDbvyUZDiPUCIAbguaSGgCbBAXo5sIxpZ4c1dcGkYyrrqnDjc1jcdJ1CASICA3c1Ak2kcGOzOh6eRXFKfpnpzP1lzfcXIYhxFGZG51mxSDBFAiEA0kdkvlA+k5kUBWVUM8SkR4Ua9pnXF66ECVwIM1l0doACIF0aMiORVC35+M3GHF2Vl8Q7t455mebrr1HuLaAyxBOYASICA75YDXRLDLt+eX5UsE03mIGUSsQP2MrJ9lm17cGXDw2mRzBEAiBPJlQEnuVDHgfgOdTZNlIcRZz2iqHoMWfDmLMFqJSOQAIgCuOcTKp/VaaqwIjnYfMKO3eQ1k9pOygSWt6teT1o13QBAQV3IQN3NQJNpHBjszoenkVxSn6Z6cz9Zc33FyGIcRRmRudZsax8IQO+WA10Swy7fnl+VLBNN5iBlErED9jKyfZZte3Blw8NpqyTfCECLzY2j/psDQtA7YGgehDQfwzz5W1A0evjWeEsNO9I8zisk3x2Y1KyaWiTU4ciBgIvNjaP+mwNC0DtgaB6ENB/DPPlbUDR6+NZ4Sw070jzOBjeQeVtVAAAgAEAAIAAAACAAAAAAAAAAAAiBgN3NQJNpHBjszoenkVxSn6Z6cz9Zc33FyGIcRRmRudZsQwpbm6KAAAAAAAAAAAiBgO+WA10Swy7fnl+VLBNN5iBlErED9jKyfZZte3Blw8NpgxDMaXmAAAAAAAAAAABBwABCP1TAQUARzBEAiBE9dLAUt/MPVhDPDkUZgDROCJD4PzyFI5UNu/JRkOI9QIgBuC5pIaAJsEBejmwjGlnhzV1waRjKuuqcONzWNx0nUIBRzBEAiBPJlQEnuVDHgfgOdTZNlIcRZz2iqHoMWfDmLMFqJSOQAIgCuOcTKp/VaaqwIjnYfMKO3eQ1k9pOygSWt6teT1o13QBSDBFAiEA0kdkvlA+k5kUBWVUM8SkR4Ua9pnXF66ECVwIM1l0doACIF0aMiORVC35+M3GHF2Vl8Q7t455mebrr1HuLaAyxBOYAXchA3c1Ak2kcGOzOh6eRXFKfpnpzP1lzfcXIYhxFGZG51mxrHwhA75YDXRLDLt+eX5UsE03mIGUSsQP2MrJ9lm17cGXDw2mrJN8IQIvNjaP+mwNC0DtgaB6ENB/DPPlbUDR6+NZ4Sw070jzOKyTfHZjUrJpaJNThwAA"')]),s._v("\n")])])]),a("h3",{attrs:{id:"step-7a-broadcast-finalized-psbt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-7a-broadcast-finalized-psbt"}},[s._v("#")]),s._v(" Step 7a: Broadcast finalized PSBT")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("bdk-cli wallet -w carol -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CAROL_DESCRIPTOR")]),s._v(" broadcast --psbt "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$FINAL_PSBT")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"txid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"3b9a7ac610afc91f1d1a0dd844e609376278fe7210c69b7ef663c5a8e8308f3e"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h3",{attrs:{id:"step-8a-confirm-transaction-included-in-a-testnet-block"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-8a-confirm-transaction-included-in-a-testnet-block"}},[s._v("#")]),s._v(" Step 8a: Confirm transaction included in a testnet block")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://mempool.space/testnet/tx/3b9a7ac610afc91f1d1a0dd844e609376278fe7210c69b7ef663c5a8e8308f3e",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://mempool.space/testnet/tx/3b9a7ac610afc91f1d1a0dd844e609376278fe7210c69b7ef663c5a8e8308f3e"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("And new wallet balance is now zero.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("bdk-cli wallet -w alice -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_DESCRIPTOR")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nbdk-cli wallet -w alice -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_DESCRIPTOR")]),s._v(" get_balance\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"satoshi"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h3",{attrs:{id:"done-"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#done-"}},[s._v("#")]),s._v(" DONE!")]),s._v(" "),a("h2",{attrs:{id:"policy-b-two-signatures-after-a-relative-time-lock"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#policy-b-two-signatures-after-a-relative-time-lock"}},[s._v("#")]),s._v(" Policy B. Two signatures after a relative time lock")]),s._v(" "),a("p",[s._v("Now we will use the same extended private and public keys, and the same descriptors to receive and spend testnet bitcoin using only two of our participants signatures after the transaction input's relative time-lock has expired.")]),s._v(" "),a("h3",{attrs:{id:"step-1b-create-a-new-testnet-receive-address"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-1b-create-a-new-testnet-receive-address"}},[s._v("#")]),s._v(" Step 1b: Create a new testnet receive address")]),s._v(" "),a("p",[s._v("The receive address can still be generated by Alice, Bob, or Carol.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("bdk-cli wallet -w alice -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_DESCRIPTOR")]),s._v(" get_new_address\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"address"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tb1q886w2zmtakwxpngs9kn7y0a7tvd6e24u58sse2sv92zrjpnenfhqtfnmw9"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h3",{attrs:{id:"step-2b-fund-new-address-from-testnet-faucet"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-2b-fund-new-address-from-testnet-faucet"}},[s._v("#")]),s._v(" Step 2b: Fund new address from testnet faucet")]),s._v(" "),a("p",[s._v("After the faucet payment is sent, confirm using a testnet block explorer to verify the transaction was included in a block.")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://mempool.space/testnet/address/tb1q886w2zmtakwxpngs9kn7y0a7tvd6e24u58sse2sv92zrjpnenfhqtfnmw9",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://mempool.space/testnet/address/tb1q886w2zmtakwxpngs9kn7y0a7tvd6e24u58sse2sv92zrjpnenfhqtfnmw9"),a("OutboundLink")],1)]),s._v(" "),a("h3",{attrs:{id:"step-3b-sync-wallet-and-confirm-wallet-balance"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-3b-sync-wallet-and-confirm-wallet-balance"}},[s._v("#")]),s._v(" Step 3b: Sync wallet and confirm wallet balance")]),s._v(" "),a("p",[s._v("This step must be done by Alice and Bob so their individual descriptor wallets know about the faucet transaction they will later be spending the output of.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("bdk-cli wallet -w alice -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_DESCRIPTOR")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nbdk-cli wallet -w alice -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_DESCRIPTOR")]),s._v(" get_balance\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"satoshi"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nbdk-cli wallet -w bob -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BOB_DESCRIPTOR")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nbdk-cli wallet -w bob -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BOB_DESCRIPTOR")]),s._v(" get_balance\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"satoshi"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# NO CAROL SHE LOST HER KEY!")]),s._v("\n")])])]),a("h3",{attrs:{id:"step-4b-create-spending-transaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-4b-create-spending-transaction"}},[s._v("#")]),s._v(" Step 4b: Create spending transaction")]),s._v(" "),a("p",[s._v("This spending transaction uses Alice and Bob's keys plus a two block relative time-lock, see above "),a("a",{attrs:{href:"#step-4a-view-wallet-spending-policies"}},[s._v("Step 4a")]),s._v(" for the policy id. The transaction can be created by Alice or Bob.")]),s._v(" "),a("p",[s._v("A time based relative time-lock can be used instead of one based on blocks but is slightly more complicated to calculate. See\n"),a("a",{attrs:{href:"https://github.com/bitcoin/bips/blob/master/bip-0068.mediawiki#specification",target:"_blank",rel:"noopener noreferrer"}},[s._v("BIP-68"),a("OutboundLink")],1),s._v(" for the details.")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("bdk-cli wallet -w alice -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_DESCRIPTOR")]),s._v(" create_tx -a --to tb1qm5tfegjevj27yvvna9elym9lnzcf0zraxgl8z2:0 --external_policy "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{'),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("ydtnup84"),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(': [0,1,3]}"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"details"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fees"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("169")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"height"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"received"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sent"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("10000")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"timestamp"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1614059434")]),s._v(",\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"transaction"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" null,\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"txid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6a04c60dff8eeb14dc0848c663d669c34ddc30125d9564364c9414e3ff4a7d28"')]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"psbt"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cHNidP8BAFICAAAAAYmc6mhj4Cf4pcJyBvxSbCd9IB1yDGs+plzb95t7++v0AAAAAAACAAAAAWcmAAAAAAAAFgAU3RacollkleIxk+lz8my/mLCXiH0AAAAAAAEBKxAnAAAAAAAAIgAgOfTlC2vtnGDNEC2n4j++Wxusqryh4QyqDCqEOQZ5mm4BBXchAlUVWMkNwGkCxDe4ZAcyz7HI+Vpmo4A5//OvkV33PCpprHwhAq9NOHBbPEdKr8IzYEomNTk1eokAkLQ9+ZMuS/OlX+nFrJN8IQOrU70B/wo/oUUCKFQ2cIsBxx6SysE7uVwxyu0ozM4zYqyTfHZjUrJpaJNThyIGAlUVWMkNwGkCxDe4ZAcyz7HI+Vpmo4A5//OvkV33PCppGFrbRoNUAACAAQAAgAAAAIAAAAAAAQAAACIGAq9NOHBbPEdKr8IzYEomNTk1eokAkLQ9+ZMuS/OlX+nFDEMxpeYAAAAAAQAAACIGA6tTvQH/Cj+hRQIoVDZwiwHHHpLKwTu5XDHK7SjMzjNiDO66tnIAAAAAAQAAAAAA"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UNSIGNED_PSBT2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("bdk-cli wallet -w alice -d $ALICE_DESCRIPTOR create_tx -a --to tb1qm5tfegjevj27yvvna9elym9lnzcf0zraxgl8z2:0 --external_policy "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{'),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v("ydtnup84"),a("span",{pre:!0,attrs:{class:"token entity",title:'\\"'}},[s._v('\\"')]),s._v(': [0,1,3]}"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".psbt"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])])]),a("h3",{attrs:{id:"step-5b-sign-and-finalize-psbts"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-5b-sign-and-finalize-psbts"}},[s._v("#")]),s._v(" Step 5b: Sign and finalize PSBTs")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ALICE SIGNS")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ALICE_SIGNED_PSBT2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("bdk-cli wallet -w alice -d $ALICE_DESCRIPTOR sign --psbt $UNSIGNED_PSBT2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".psbt"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# BOB SIGNS")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("FINAL_PSBT2")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token variable"}},[a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("bdk-cli wallet -w bob -d $BOB_DESCRIPTOR sign --psbt $ALICE_SIGNED_PSBT2 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" jq -r "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('".psbt"')]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# CAROL DOES *NOT* SIGN")]),s._v("\n")])])]),a("h3",{attrs:{id:"step-6b-broadcast-finalized-psbt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-6b-broadcast-finalized-psbt"}},[s._v("#")]),s._v(" Step 6b: Broadcast finalized PSBT")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("bdk-cli wallet -w bob -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BOB_DESCRIPTOR")]),s._v(" broadcast --psbt "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$FINAL_PSBT2")]),s._v("\nthread "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'main'")]),s._v(" panicked at "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'called `Result::unwrap()` on an `Err` value: Electrum(Protocol(String("sendrawtransaction RPC error: {\\"code\\":-26,\\"message\\":\\"non-BIP68-final\\"}")))\'')]),s._v(", src/bdk_cli.rs:168:50\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Oops we didn't wait long enough for the relative time lock to expire")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Try again in ~20 mins and it is successfully broadcast")]),s._v("\n\nbdk-cli wallet -w bob -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$BOB_DESCRIPTOR")]),s._v(" broadcast --psbt "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$FINAL_PSBT2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"txid"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6a04c60dff8eeb14dc0848c663d669c34ddc30125d9564364c9414e3ff4a7d28"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h3",{attrs:{id:"step-7b-view-confirmed-transaction"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#step-7b-view-confirmed-transaction"}},[s._v("#")]),s._v(" Step 7b: View confirmed transaction")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://mempool.space/testnet/tx/6a04c60dff8eeb14dc0848c663d669c34ddc30125d9564364c9414e3ff4a7d28",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://mempool.space/testnet/tx/6a04c60dff8eeb14dc0848c663d669c34ddc30125d9564364c9414e3ff4a7d28"),a("OutboundLink")],1)]),s._v(" "),a("p",[s._v("And wallet balance is again zero")]),s._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("bdk-cli wallet -w alice -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_DESCRIPTOR")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sync")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nbdk-cli wallet -w alice -d "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$ALICE_DESCRIPTOR")]),s._v(" get_balance\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"satoshi"')]),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),a("h3",{attrs:{id:"done-again-"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#done-again-"}},[s._v("#")]),s._v(" Done again!")]),s._v(" "),a("p",[s._v("In this demo we showed how to receive and spend bitcoin using two different descriptor wallet policies using the "),a("code",[s._v("bdk")]),s._v(" library and "),a("code",[s._v("bdk-cli")]),s._v(" wallet tool.")])])}),[],!1,null,null,null);t.default=n.exports}}]);